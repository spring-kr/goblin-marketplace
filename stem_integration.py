"""
STEM í†µí•© AI ë„ê¹¨ë¹„ ì‹œìŠ¤í…œ - ì›ë˜ 16ê°œ ë„ê¹¨ë¹„ ë²„ì „
ë°•ì‚¬ê¸‰ AI ë„ê¹¨ë¹„ë“¤ì´ ê° ë¶„ì•¼ë³„ë¡œ ì „ë¬¸ì ì¸ ìƒë‹´ì„ ì œê³µí•©ë‹ˆë‹¤.
"""

import random
import re
from datetime import datetime
from typing import Dict, Any, Optional
from usage_tracker import UsageTracker

# ì‚¬ìš©ëŸ‰ ì¶”ì ê¸° ì´ˆê¸°í™”
usage_tracker = UsageTracker()


class STEMIntegration:
    """ì›ë˜ 16ê°œ ë°•ì‚¬ê¸‰ AI ë„ê¹¨ë¹„ ì‹œìŠ¤í…œ"""

    def __init__(self):
        self.system_name = "ğŸ° ë„ê¹¨ë¹„ë§ˆì„ì¥í„° ë°•ì‚¬ê¸‰ AI ìƒë‹´ì†Œ"

    def process_question(
        self, agent_type: str, question: str, user_ip: Optional[str] = None
    ) -> Dict[str, Any]:
        """ì‹¤ì œ AI ëŒ€í™” ëŠ¥ë ¥ìœ¼ë¡œ ì§ˆë¬¸ ì²˜ë¦¬"""
        try:
            # ì›ë˜ 16ê°œ ë„ê¹¨ë¹„ ì •ë³´
            agent_info = {
                "assistant": {
                    "emoji": "ğŸ¤–",
                    "name": "ë°•ì‚¬ê¸‰ ë¹„ì„œ ë„ê¹¨ë¹„",
                    "field": "ì—…ë¬´ ê´€ë¦¬",
                },
                "builder": {"emoji": "ğŸ’»", "name": "ë¹Œë” ë„ê¹¨ë¹„", "field": "ê°œë°œ"},
                "counselor": {"emoji": "ğŸ’¬", "name": "ìƒë‹´ ë„ê¹¨ë¹„", "field": "ìƒë‹´"},
                "creative": {"emoji": "ğŸ¨", "name": "ì°½ì‘ ë„ê¹¨ë¹„", "field": "ì°½ì‘"},
                "data_analyst": {
                    "emoji": "ğŸ“Š",
                    "name": "ë°ì´í„°ë¶„ì„ ë„ê¹¨ë¹„",
                    "field": "ë°ì´í„° ë¶„ì„",
                },
                "fortune": {"emoji": "ğŸ”®", "name": "ìš´ì„¸ ë„ê¹¨ë¹„", "field": "ìš´ì„¸"},
                "growth": {"emoji": "ğŸŒ±", "name": "ì„±ì¥ ë„ê¹¨ë¹„", "field": "ì„±ì¥"},
                "hr": {"emoji": "ğŸ‘¥", "name": "HR ë„ê¹¨ë¹„", "field": "ì¸ì‚¬ ê´€ë¦¬"},
                "marketing": {
                    "emoji": "ğŸ“ˆ",
                    "name": "ë§ˆì¼€íŒ… ë„ê¹¨ë¹„",
                    "field": "ë§ˆì¼€íŒ…",
                },
                "medical": {"emoji": "ğŸ¥", "name": "ì˜ë£Œ ë„ê¹¨ë¹„", "field": "ì˜ë£Œ"},
                "sales": {"emoji": "ğŸ’°", "name": "ì˜ì—… ë„ê¹¨ë¹„", "field": "ì˜ì—…"},
                "seo": {"emoji": "ğŸ”", "name": "SEO ë„ê¹¨ë¹„", "field": "ê²€ìƒ‰ ìµœì í™”"},
                "shopping": {"emoji": "ğŸ›’", "name": "ì‡¼í•‘ ë„ê¹¨ë¹„", "field": "ì‡¼í•‘"},
                "startup": {"emoji": "ğŸš€", "name": "ìŠ¤íƒ€íŠ¸ì—… ë„ê¹¨ë¹„", "field": "ì°½ì—…"},
                "village_chief": {
                    "emoji": "ğŸ‘‘",
                    "name": "ì´ì¥ ë„ê¹¨ë¹„",
                    "field": "ë§ˆì„ ê´€ë¦¬",
                },
                "writing": {
                    "emoji": "âœï¸",
                    "name": "ë°•ì‚¬ê¸‰ ë¬¸ì„œ ì‘ì„± ë„ê¹¨ë¹„",
                    "field": "ë¬¸ì„œ ì‘ì„±",
                },
            }

            if agent_type not in agent_info:
                # ì‹¤íŒ¨ ë¡œê·¸ ê¸°ë¡
                usage_tracker.log_usage(agent_type, question, False, user_ip)
                return {
                    "success": False,
                    "error": f"ì§€ì›í•˜ì§€ ì•ŠëŠ” ì—ì´ì „íŠ¸ íƒ€ì…: {agent_type}",
                }

            # ì§ˆë¬¸ ìœ íš¨ì„± ê²€ì‚¬
            if not question or len(question.strip()) < 2:
                usage_tracker.log_usage(agent_type, question, False, user_ip)
                return {
                    "success": False,
                    "error": "ì§ˆë¬¸ì´ ë„ˆë¬´ ì§§ìŠµë‹ˆë‹¤. ìµœì†Œ 2ê¸€ì ì´ìƒ ì…ë ¥í•´ì£¼ì„¸ìš”.",
                }

            # ë„ê¹¨ë¹„ë³„ ì „ë¬¸ ì‘ë‹µ ìƒì„±
            info = agent_info[agent_type]
            response = self._generate_smart_response(question, agent_type, info)

            # ì„±ê³µ ë¡œê·¸ ê¸°ë¡
            usage_tracker.log_usage(agent_type, question, True, user_ip)

            return {
                "success": True,
                "agent": {
                    "type": agent_type,
                    "name": info["name"],
                    "emoji": info["emoji"],
                    "field": info["field"],
                },
                "response": response,
                "timestamp": datetime.now().isoformat(),
            }

        except Exception as e:
            # ì—ëŸ¬ ë¡œê·¸ ê¸°ë¡
            usage_tracker.log_usage(agent_type, question, False, user_ip)
            return {"success": False, "error": f"ì²˜ë¦¬ ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤: {str(e)}"}

    def _generate_smart_response(
        self, question: str, agent_type: str, info: dict
    ) -> str:
        """ë„ê¹¨ë¹„ë³„ ì „ë¬¸ ì‘ë‹µ ìƒì„±"""

        # ê° ë„ê¹¨ë¹„ë³„ ì „ë¬¸ ì‘ë‹µ í•¨ìˆ˜ í˜¸ì¶œ
        response_methods = {
            "assistant": self._assistant_expert_response,
            "builder": self._builder_expert_response,
            "counselor": self._counselor_expert_response,
            "creative": self._creative_expert_response,
            "data_analyst": self._data_analyst_expert_response,
            "fortune": self._fortune_expert_response,
            "growth": self._growth_expert_response,
            "hr": self._hr_expert_response,
            "marketing": self._marketing_expert_response,
            "medical": self._medical_expert_response,
            "sales": self._sales_expert_response,
            "seo": self._seo_expert_response,
            "shopping": self._shopping_expert_response,
            "startup": self._startup_expert_response,
            "village_chief": self._village_chief_expert_response,
            "writing": self._writing_expert_response,
        }

        if agent_type in response_methods:
            return response_methods[agent_type](question, info)
        else:
            return self._general_expert_response(question, info)

    def _assistant_expert_response(self, question: str, info: dict) -> str:
        """ë°•ì‚¬ê¸‰ ë¹„ì„œ ë„ê¹¨ë¹„ ì „ë¬¸ ì‘ë‹µ - ì‹¤ì œ AI ëŒ€í™”"""
        # ì§ˆë¬¸ í‚¤ì›Œë“œ ë¶„ì„ìœ¼ë¡œ ë§ì¶¤ ì‘ë‹µ
        question_lower = question.lower()
        
        # ì¼ì •/ì‹œê°„ ê´€ë¦¬ ê´€ë ¨
        if any(keyword in question_lower for keyword in ['ì¼ì •', 'ìŠ¤ì¼€ì¤„', 'ê³„íš', 'ì‹œê°„', 'ê´€ë¦¬']):
            return f"{info['emoji']} ì•ˆë…•í•˜ì„¸ìš”! {info['name']}ì…ë‹ˆë‹¤.\n\n'{question}' ê´€ë ¨ ì‹œê°„ ê´€ë¦¬ ì „ë¬¸ ì¡°ì–¸ì„ ë“œë¦¬ê² ìŠµë‹ˆë‹¤.\n\nâ° **íš¨ìœ¨ì  ì‹œê°„ ê´€ë¦¬ë²•:**\nâ€¢ ì¤‘ìš”ë„Ã—ê¸´ê¸‰ë„ ë§¤íŠ¸ë¦­ìŠ¤ë¡œ ìš°ì„ ìˆœìœ„ ì„¤ì •\nâ€¢ 25ë¶„ ì§‘ì¤‘ + 5ë¶„ íœ´ì‹ í¬ëª¨ë„ë¡œ ê¸°ë²•\nâ€¢ í•˜ë£¨ 20% ë²„í¼ íƒ€ì„ í™•ë³´\n\nğŸ“… **ì¼ì • ìµœì í™”:**\nâ€¢ ë¹„ìŠ·í•œ ì—…ë¬´ëŠ” ë°°ì¹˜ ì²˜ë¦¬\nâ€¢ ì—ë„ˆì§€ ë†’ì€ ì‹œê°„ëŒ€ì— ì–´ë ¤ìš´ ì—…ë¬´\nâ€¢ ì£¼ê°„/ì›”ê°„ ì •ê¸° ë¦¬ë·° ì‹¤ì‹œ\n\nğŸ¯ **ì¦‰ì‹œ ì‹¤í–‰ íŒ:**\nì˜¤ëŠ˜ë¶€í„° ê°€ì¥ ì¤‘ìš”í•œ ì—…ë¬´ 3ê°œë§Œ ì„ ì •í•´ë³´ì„¸ìš”!"
        
        # íšŒì˜/ì†Œí†µ ê´€ë ¨
        elif any(keyword in question_lower for keyword in ['íšŒì˜', 'ë¯¸íŒ…', 'ì†Œí†µ', 'ì»¤ë®¤ë‹ˆì¼€ì´ì…˜', 'ë°œí‘œ']):
            return f"{info['emoji']} {info['name']}ê°€ íšŒì˜ íš¨ìœ¨ì„± ì „ë¬¸ê°€ë¡œ ë‹µë³€ë“œë¦½ë‹ˆë‹¤!\n\n'{question}' ê´€ë ¨ ì†Œí†µ ìµœì í™” ë°©ì•ˆì…ë‹ˆë‹¤.\n\nğŸ’¬ **íš¨ê³¼ì  íšŒì˜ ìš´ì˜:**\nâ€¢ ëª…í™•í•œ ëª©ì ê³¼ ì•„ì  ë‹¤ ì‚¬ì „ ê³µìœ \nâ€¢ ì‹œê°„ í•œê³„ ì„¤ì • (ìµœëŒ€ 1ì‹œê°„)\nâ€¢ ì•¡ì…˜ ì•„ì´í…œê³¼ ë‹´ë‹¹ì ëª…ì‹œ\n\nğŸ¯ **ì°¸ì—¬ë„ ê·¹ëŒ€í™”:**\nâ€¢ ëª¨ë“  ì°¸ì„ì ë°œì–¸ ê¸°íšŒ ì œê³µ\nâ€¢ ê²°ì •ì‚¬í•­ ì‹¤ì‹œê°„ ê¸°ë¡\nâ€¢ íšŒì˜ í›„ 24ì‹œê°„ ë‚´ ìš”ì•½ ê³µìœ \n\nï¿½ **ì„±ê³¼ ì¸¡ì •:**\níšŒì˜ ë§Œì¡±ë„ì™€ ì‹¤í–‰ë¥ ì„ ì •ê¸° ì²´í¬í•˜ì„¸ìš”!"
        
        # ì—…ë¬´ íš¨ìœ¨/ìƒì‚°ì„± ê´€ë ¨
        elif any(keyword in question_lower for keyword in ['ì—…ë¬´', 'ìƒì‚°ì„±', 'íš¨ìœ¨', 'ì„±ê³¼', 'ëª©í‘œ']):
            return f"{info['emoji']} {info['name']}ê°€ ìƒì‚°ì„± ì „ë¬¸ê°€ë¡œ ì¡°ì–¸ë“œë¦½ë‹ˆë‹¤!\n\n'{question}'ì— ëŒ€í•œ ì—…ë¬´ íš¨ìœ¨ì„± í–¥ìƒ ë°©ì•ˆì…ë‹ˆë‹¤.\n\nâš¡ **ìƒì‚°ì„± ë¶€ìŠ¤í„°:**\nâ€¢ 2ë¶„ ë£°: 2ë¶„ ë‚´ ê°€ëŠ¥í•œ ì¼ì€ ì¦‰ì‹œ ì²˜ë¦¬\nâ€¢ ë©€í‹°íƒœìŠ¤í‚¹ ê¸ˆì§€, í•œ ë²ˆì— í•˜ë‚˜ì”©\nâ€¢ ì—…ë¬´ í™˜ê²½ ìµœì í™” (ì •ë¦¬ì •ëˆ í•„ìˆ˜)\n\nğŸ§  **ì—ë„ˆì§€ ê´€ë¦¬:**\nâ€¢ ê°œì¸ë³„ í™©ê¸ˆ ì‹œê°„ëŒ€ íŒŒì•… í™œìš©\nâ€¢ ì–´ë ¤ìš´ ì—…ë¬´ëŠ” ì»¨ë””ì…˜ ì¢‹ì„ ë•Œ\nâ€¢ ì •ê¸°ì  íœ´ì‹ìœ¼ë¡œ ì§€ì† ê°€ëŠ¥í•œ ë¦¬ë“¬\n\nï¿½ **ì„±ê³¼ ì¶”ì :**\nì£¼ê°„ ë‹¨ìœ„ ì—…ë¬´ ì™„ë£Œìœ¨ê³¼ í’ˆì§ˆ ì ê²€í•˜ì„¸ìš”!"
        
        # ì¼ë°˜ì ì¸ ì—…ë¬´ ê´€ë¦¬ ì§ˆë¬¸
        else:
            return f"{info['emoji']} ì•ˆë…•í•˜ì„¸ìš”! {info['name']}ì…ë‹ˆë‹¤.\n\n'{question}'ì— ëŒ€í•´ ì—…ë¬´ ê´€ë¦¬ ì „ë¬¸ê°€ë¡œì„œ ì¡°ì–¸ë“œë¦¬ê² ìŠµë‹ˆë‹¤.\n\nğŸ“‹ **ì¢…í•© ë¶„ì„:**\nì²´ê³„ì ì¸ ì—…ë¬´ ê´€ë¦¬ê°€ ì„±ê³µì˜ í•µì‹¬ì…ë‹ˆë‹¤.\n\nâœ… **í•µì‹¬ ì›ì¹™:**\nâ€¢ ëª…í™•í•œ ëª©í‘œ ì„¤ì •ê³¼ ìš°ì„ ìˆœìœ„ ê´€ë¦¬\nâ€¢ ì‹œê°„ê³¼ ì—ë„ˆì§€ ìì›ì˜ ìµœì  ë°°ë¶„\nâ€¢ ì§€ì†ì ì¸ ê°œì„ ê³¼ í”¼ë“œë°± ë°˜ì˜\n\nğŸ’¡ **ë§ì¶¤ ì†”ë£¨ì…˜:**\nêµ¬ì²´ì ì¸ ìƒí™©ì„ ë” ì•Œë ¤ì£¼ì‹œë©´ ë” ì •í™•í•œ ì¡°ì–¸ì„ ë“œë¦´ ìˆ˜ ìˆìŠµë‹ˆë‹¤!\n\nğŸš€ **ì‹œì‘ ì œì•ˆ:**\nì˜¤ëŠ˜ë¶€í„° ì‘ì€ ìŠµê´€ í•˜ë‚˜ì”© ê°œì„ í•´ë³´ì„¸ìš”."

    def _builder_expert_response(self, question: str, info: dict) -> str:
        """ë¹Œë” ë„ê¹¨ë¹„ ì „ë¬¸ ì‘ë‹µ"""
        responses = [
            f"{info['emoji']} ì•ˆë…•í•˜ì„¸ìš”! {info['name']}ì…ë‹ˆë‹¤.\n\nê°œë°œ ê´€ë ¨ ì§ˆë¬¸ì— ì „ë¬¸ì ìœ¼ë¡œ ë‹µë³€ë“œë¦¬ê² ìŠµë‹ˆë‹¤:\n\nğŸ’» **ê¸°ìˆ  ë¶„ì„:**\n'{question}'ì— ëŒ€í•œ ê°œë°œ ì†”ë£¨ì…˜ì„ ì œì‹œí•˜ê² ìŠµë‹ˆë‹¤.\n\nğŸ› ï¸ **ê¶Œì¥ ê¸°ìˆ ìŠ¤íƒ:**\nâ€¢ í”„ë¡ íŠ¸ì—”ë“œ: React/Vue.js\nâ€¢ ë°±ì—”ë“œ: Python/Node.js\nâ€¢ ë°ì´í„°ë² ì´ìŠ¤: PostgreSQL/MongoDB\n\nğŸš€ **êµ¬í˜„ ë°©ì•ˆ:**\nMVPë¶€í„° ì‹œì‘í•´ì„œ ë‹¨ê³„ì ìœ¼ë¡œ í™•ì¥í•˜ì„¸ìš”!",
            f"{info['emoji']} {info['name']}ê°€ ê°œë°œ ì†”ë£¨ì…˜ì„ ì œê³µí•©ë‹ˆë‹¤!\n\nğŸ”§ **ì•„í‚¤í…ì²˜ ì„¤ê³„:**\n'{question}'ì— ìµœì í™”ëœ ì‹œìŠ¤í…œ êµ¬ì¡°ë¥¼ ì„¤ê³„í–ˆìŠµë‹ˆë‹¤.\n\nğŸ“± **ê°œë°œ ë¡œë“œë§µ:**\nâ€¢ 1ë‹¨ê³„: í”„ë¡œí† íƒ€ì… ê°œë°œ\nâ€¢ 2ë‹¨ê³„: í•µì‹¬ ê¸°ëŠ¥ êµ¬í˜„\nâ€¢ 3ë‹¨ê³„: í™•ì¥ì„± ê³ ë ¤\n\nâš¡ **ì„±ëŠ¥ ìµœì í™”:**\ní™•ì¥ ê°€ëŠ¥í•˜ê³  ìœ ì§€ë³´ìˆ˜ê°€ ì‰¬ìš´ ì½”ë“œë¡œ êµ¬í˜„í•˜ê² ìŠµë‹ˆë‹¤!",
        ]
        return random.choice(responses)

    def _counselor_expert_response(self, question: str, info: dict) -> str:
        """ìƒë‹´ ë„ê¹¨ë¹„ ì „ë¬¸ ì‘ë‹µ"""
        responses = [
            f"{info['emoji']} ì•ˆë…•í•˜ì„¸ìš”! {info['name']}ì…ë‹ˆë‹¤.\n\në§ˆìŒì˜ ê³ ë¯¼ì„ í•¨ê»˜ ë‚˜ëˆ„ê² ìŠµë‹ˆë‹¤:\n\nğŸ’­ **ìƒí™© ì´í•´:**\n'{question}'ì— ëŒ€í•´ ê¹Šì´ ê³µê°í•˜ë©° ë“¤ì–´ë“œë ¸ìŠµë‹ˆë‹¤.\n\nğŸ¤— **ì‹¬ë¦¬ì  ì§€ì›:**\nâ€¢ ê°ì • ì¸ì •ê³¼ ìˆ˜ìš©\nâ€¢ ê¸ì •ì  ê´€ì  ì „í™˜\nâ€¢ ì‹¤í–‰ ê°€ëŠ¥í•œ í•´ê²°ì±…\n\nğŸŒˆ **í¬ë§ ë©”ì‹œì§€:**\nì–´ë ¤ìš´ ì‹œê¸°ë„ ì„±ì¥ì˜ ê¸°íšŒê°€ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤!",
            f"{info['emoji']} {info['name']}ê°€ ë”°ëœ»í•˜ê²Œ ìƒë‹´í•´ë“œë¦½ë‹ˆë‹¤.\n\nğŸ’ **ê³µê°ê³¼ ì´í•´:**\n'{question}'ì— ë‹´ê¸´ ë§ˆìŒì„ ì¶©ë¶„íˆ ì´í•´í•©ë‹ˆë‹¤.\n\nğŸ” **ë¬¸ì œ ë¶„ì„:**\nâ€¢ í•µì‹¬ ì´ìŠˆ íŒŒì•…\nâ€¢ ê°ì • ìƒíƒœ ì ê²€\nâ€¢ í•´ê²° ë°©í–¥ ëª¨ìƒ‰\n\nâœ¨ **ë³€í™”ì˜ ì‹œì‘:**\nì‘ì€ ë³€í™”ë¶€í„° ì‹œì‘í•´ë³´ì„¸ìš”. ì‘ì›í•˜ê² ìŠµë‹ˆë‹¤!",
        ]
        return random.choice(responses)

    def _creative_expert_response(self, question: str, info: dict) -> str:
        """ì°½ì‘ ë„ê¹¨ë¹„ ì „ë¬¸ ì‘ë‹µ"""
        responses = [
            f"{info['emoji']} ì•ˆë…•í•˜ì„¸ìš”! {info['name']}ì…ë‹ˆë‹¤.\n\nì°½ì‘ ì˜ê°ì„ ë¶ˆëŸ¬ì¼ìœ¼ì¼œë“œë¦¬ê² ìŠµë‹ˆë‹¤:\n\nğŸ­ **ì°½ì‘ ì•„ì´ë””ì–´:**\n'{question}'ì—ì„œ ë¬´í•œí•œ ê°€ëŠ¥ì„±ì„ ë°œê²¬í–ˆìŠµë‹ˆë‹¤!\n\nğŸŒŸ **ì˜ê° í¬ì¸íŠ¸:**\nâ€¢ ë…ì°½ì  ê´€ì  ì œì‹œ\nâ€¢ ê°ì„±ì  ìŠ¤í† ë¦¬í…”ë§\nâ€¢ ì‹œê°ì  ì„íŒ©íŠ¸ ê°•í™”\n\nğŸ¨ **ì‹¤í–‰ ë°©ë²•:**\nì°½ì˜ì„±ê³¼ ì²´ê³„ì„±ì„ ì¡°í™”ë¡­ê²Œ ê²°í•©í•´ë³´ì„¸ìš”!",
            f"{info['emoji']} {info['name']}ê°€ ì°½ì‘ ì—¬ì •ì„ í•¨ê»˜í•©ë‹ˆë‹¤!\n\nğŸ’¡ **ë¸Œë ˆì¸ìŠ¤í† ë°:**\n'{question}'ì„ í†µí•´ ìƒˆë¡œìš´ ì•„ì´ë””ì–´ë¥¼ ë°œêµ´í–ˆìŠµë‹ˆë‹¤.\n\nğŸª **ì°½ì‘ ì „ëµ:**\nâ€¢ ì˜¤ë¦¬ì§€ë„ë¦¬í‹° í™•ë³´\nâ€¢ íƒ€ê²Ÿ ì˜¤ë””ì–¸ìŠ¤ ê³ ë ¤\nâ€¢ íŠ¸ë Œë“œì™€ ê°œì„±ì˜ ê· í˜•\n\nğŸš€ **ì°½ì‘ íŒ:**\nì™„ë²½í•¨ë³´ë‹¤ ì§„ì •ì„±ì´ ë” ê°•ë ¥í•œ í˜ì„ ë°œíœ˜í•©ë‹ˆë‹¤!",
        ]
        return random.choice(responses)

    def _data_analyst_expert_response(self, question: str, info: dict) -> str:
        """ë°ì´í„°ë¶„ì„ ë„ê¹¨ë¹„ ì „ë¬¸ ì‘ë‹µ"""
        responses = [
            f"{info['emoji']} ì•ˆë…•í•˜ì„¸ìš”! {info['name']}ì…ë‹ˆë‹¤.\n\në°ì´í„° ê¸°ë°˜ í†µì°°ë ¥ì„ ì œê³µí•˜ê² ìŠµë‹ˆë‹¤:\n\nğŸ“ˆ **ë°ì´í„° ë¶„ì„:**\n'{question}'ì— ëŒ€í•œ ì •ëŸ‰ì  ë¶„ì„ ê²°ê³¼ì…ë‹ˆë‹¤.\n\nğŸ” **í•µì‹¬ ì¸ì‚¬ì´íŠ¸:**\nâ€¢ íŒ¨í„´ ì¸ì‹ ë° íŠ¸ë Œë“œ ë¶„ì„\nâ€¢ ì˜ˆì¸¡ ëª¨ë¸ë§\nâ€¢ ì˜ì‚¬ê²°ì • ì§€ì› ë°ì´í„°\n\nğŸ“Š **í™œìš© ë°©ì•ˆ:**\në°ì´í„°ë¥¼ í†µí•´ í™•ì‹¤í•œ ì„±ê³¼ë¥¼ ë§Œë“¤ì–´ë³´ì„¸ìš”!",
            f"{info['emoji']} {info['name']}ê°€ ë°ì´í„°ë¡œ ë‹µë³€ë“œë¦½ë‹ˆë‹¤!\n\nğŸ§® **í†µê³„ì  ì ‘ê·¼:**\n'{question}'ì„ ìˆ˜ì¹˜ì™€ ê·¸ë˜í”„ë¡œ ë¶„ì„í–ˆìŠµë‹ˆë‹¤.\n\nğŸ“‹ **ë¶„ì„ ê²°ê³¼:**\nâ€¢ ìƒê´€ê´€ê³„ ë¶„ì„\nâ€¢ ì„±ê³¼ ì§€í‘œ ì¸¡ì •\nâ€¢ ROI ê³„ì‚°\n\nâš¡ **ì‹¤í–‰ë ¥:**\në°ì´í„° ê¸°ë°˜ ì˜ì‚¬ê²°ì •ìœ¼ë¡œ ì„±ê³µ í™•ë¥ ì„ ë†’ì´ì„¸ìš”!",
        ]
        return random.choice(responses)

    def _fortune_expert_response(self, question: str, info: dict) -> str:
        """ìš´ì„¸ ë„ê¹¨ë¹„ ì „ë¬¸ ì‘ë‹µ"""
        responses = [
            f"{info['emoji']} ì•ˆë…•í•˜ì„¸ìš”! {info['name']}ì…ë‹ˆë‹¤.\n\nìš´ëª…ì˜ ì‹¤ì„ ë“¤ì—¬ë‹¤ë³´ê² ìŠµë‹ˆë‹¤:\n\nğŸŒ™ **ìš´ì„¸ í•´ì„:**\n'{question}'ì— ëŒ€í•œ ìš°ì£¼ì˜ ë©”ì‹œì§€ë¥¼ ì „ë‹¬í•©ë‹ˆë‹¤.\n\nâ­ **ê¸¸ìš´ í¬ì¸íŠ¸:**\nâ€¢ ê¸ì •ì  ì—ë„ˆì§€ íë¦„\nâ€¢ ê¸°íšŒì˜ íƒ€ì´ë°\nâ€¢ ì£¼ì˜í•´ì•¼ í•  ìš”ì†Œ\n\nğŸ€ **í–‰ìš´ íŒ:**\në§ˆìŒê°€ì§ì„ ë°ê²Œ í•˜ë©´ ì¢‹ì€ ì¼ì´ ì°¾ì•„ì˜¬ ê²ƒì…ë‹ˆë‹¤!",
            f"{info['emoji']} {info['name']}ê°€ ì‹ ë¹„ë¡œìš´ ë‹µë³€ì„ ë“œë¦½ë‹ˆë‹¤!\n\nğŸ”® **ë¯¸ë˜ ì „ë§:**\n'{question}'ì— ìˆ¨ê²¨ì§„ ìš´ëª…ì˜ ì‹ í˜¸ë¥¼ ì½ì—ˆìŠµë‹ˆë‹¤.\n\nâœ¨ **ìš´ì„¸ ì¡°ì–¸:**\nâ€¢ í–‰ìš´ì˜ ìƒ‰ê¹”ê³¼ ìˆ«ì\nâ€¢ í”¼í•´ì•¼ í•  ì‹œê¸°\nâ€¢ ì„±ê³µì„ ìœ„í•œ ë°©í–¥\n\nğŸŒŸ **í¬ë§ ë©”ì‹œì§€:**\në‹¹ì‹ ì˜ ë…¸ë ¥ê³¼ ìš´ì´ ë§Œë‚˜ëŠ” ìˆœê°„ì´ ë‹¤ê°€ì˜µë‹ˆë‹¤!",
        ]
        return random.choice(responses)

    def _growth_expert_response(self, question: str, info: dict) -> str:
        """ì„±ì¥ ë„ê¹¨ë¹„ ì „ë¬¸ ì‘ë‹µ"""
        responses = [
            f"{info['emoji']} ì•ˆë…•í•˜ì„¸ìš”! {info['name']}ì…ë‹ˆë‹¤.\n\nì„±ì¥ì˜ ê¸¸ì„ í•¨ê»˜ ê±¸ì–´ê°€ê² ìŠµë‹ˆë‹¤:\n\nğŸŒ± **ì„±ì¥ ë¶„ì„:**\n'{question}'ì—ì„œ ë°œì „ ê°€ëŠ¥ì„±ì„ ë°œê²¬í–ˆìŠµë‹ˆë‹¤.\n\nğŸ“ˆ **ì„±ì¥ ì „ëµ:**\nâ€¢ ë‹¨ê³„ë³„ ëª©í‘œ ì„¤ì •\nâ€¢ ì—­ëŸ‰ ê°•í™” ë°©ë²•\nâ€¢ ì§€ì† ê°€ëŠ¥í•œ ë°œì „\n\nğŸ† **ì„±ê³µ ë¹„ê²°:**\nê¾¸ì¤€í•¨ì´ ìµœê³ ì˜ ì„±ì¥ ë™ë ¥ì…ë‹ˆë‹¤!",
            f"{info['emoji']} {info['name']}ê°€ ì„±ì¥ ì—¬ì •ì„ ì•ˆë‚´í•©ë‹ˆë‹¤!\n\nğŸš€ **ì„±ì¥ ë¡œë“œë§µ:**\n'{question}'ì„ í†µí•´ ë§ì¶¤í˜• ì„±ì¥ ê³„íšì„ ì„¸ì› ìŠµë‹ˆë‹¤.\n\nğŸ’ª **ì—­ëŸ‰ ê°œë°œ:**\nâ€¢ ê°•ì  ê·¹ëŒ€í™”\nâ€¢ ì•½ì  ë³´ì™„\nâ€¢ ìƒˆë¡œìš´ ê¸°íšŒ ì°½ì¶œ\n\nâ­ **ë™ê¸°ë¶€ì—¬:**\në§¤ì¼ ì¡°ê¸ˆì”© ì„±ì¥í•˜ëŠ” ë‹¹ì‹ ì´ ë  ìˆ˜ ìˆìŠµë‹ˆë‹¤!",
        ]
        return random.choice(responses)

    def _hr_expert_response(self, question: str, info: dict) -> str:
        """HR ë„ê¹¨ë¹„ ì „ë¬¸ ì‘ë‹µ"""
        responses = [
            f"{info['emoji']} ì•ˆë…•í•˜ì„¸ìš”! {info['name']}ì…ë‹ˆë‹¤.\n\nì¸ì‚¬ ê´€ë¦¬ ì „ë¬¸ ì¡°ì–¸ì„ ë“œë¦¬ê² ìŠµë‹ˆë‹¤:\n\nğŸ‘¥ **ì¸ì‚¬ ì „ëµ:**\n'{question}'ì— ëŒ€í•œ HR ì†”ë£¨ì…˜ì„ ì œì‹œí•©ë‹ˆë‹¤.\n\nğŸ¯ **í•µì‹¬ í¬ì¸íŠ¸:**\nâ€¢ ì¸ì¬ ì±„ìš© ë° ìœ¡ì„±\nâ€¢ ì¡°ì§ ë¬¸í™” ê°œì„ \nâ€¢ ì„±ê³¼ ê´€ë¦¬ ì‹œìŠ¤í…œ\n\nğŸ’¼ **ì‹¤í–‰ ë°©ì•ˆ:**\nì‚¬ëŒ ì¤‘ì‹¬ì˜ ê²½ì˜ìœ¼ë¡œ ì¡°ì§ì„ ê°•í™”í•˜ì„¸ìš”!",
            f"{info['emoji']} {info['name']}ê°€ ì¸ì‚¬ ì „ë¬¸ê°€ë¡œ ë‹µë³€ë“œë¦½ë‹ˆë‹¤!\n\nğŸ¢ **ì¡°ì§ ì§„ë‹¨:**\n'{question}'ì„ í†µí•´ ì¡°ì§ì˜ ê±´ê°•ë„ë¥¼ ì²´í¬í–ˆìŠµë‹ˆë‹¤.\n\nğŸ“Š **HR ì†”ë£¨ì…˜:**\nâ€¢ ì§ì› ë§Œì¡±ë„ í–¥ìƒ\nâ€¢ ì—…ë¬´ íš¨ìœ¨ì„± ì¦ëŒ€\nâ€¢ ë¦¬ë”ì‹­ ê°œë°œ\n\nğŸŒŸ **ê¸°ëŒ€ íš¨ê³¼:**\ní–‰ë³µí•œ ì§ì¥ì´ ìµœê³ ì˜ ì„±ê³¼ë¥¼ ë§Œë“¤ì–´ëƒ…ë‹ˆë‹¤!",
        ]
        return random.choice(responses)

    def _marketing_expert_response(self, question: str, info: dict) -> str:
        """ë§ˆì¼€íŒ… ë„ê¹¨ë¹„ ì „ë¬¸ ì‘ë‹µ"""
        responses = [
            f"{info['emoji']} ì•ˆë…•í•˜ì„¸ìš”! {info['name']}ì…ë‹ˆë‹¤.\n\në§ˆì¼€íŒ… ì „ëµì„ ìˆ˜ë¦½í•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤:\n\nğŸ“Š **ì‹œì¥ ë¶„ì„:**\n'{question}'ì— ëŒ€í•œ ë§ˆì¼€íŒ… ì¸ì‚¬ì´íŠ¸ë¥¼ ì œê³µí•©ë‹ˆë‹¤.\n\nğŸ¯ **ì „ëµ í¬ì¸íŠ¸:**\nâ€¢ íƒ€ê²Ÿ ê³ ê° ì„¸ë¶„í™”\nâ€¢ ì°¨ë³„í™”ëœ í¬ì§€ì…”ë‹\nâ€¢ íš¨ê³¼ì ì¸ ì±„ë„ ë¯¹ìŠ¤\n\nğŸš€ **ì‹¤í–‰ ê³„íš:**\në°ì´í„° ê¸°ë°˜ ë§ˆì¼€íŒ…ìœ¼ë¡œ ROIë¥¼ ê·¹ëŒ€í™”í•˜ì„¸ìš”!",
            f"{info['emoji']} {info['name']}ê°€ ë§ˆì¼€íŒ… ì†”ë£¨ì…˜ì„ ì œê³µí•©ë‹ˆë‹¤!\n\nğŸ“ˆ **ì„±ì¥ ì „ëµ:**\n'{question}'ì„ í†µí•´ ë¸Œëœë“œ ì„±ì¥ ë°©ì•ˆì„ ë„ì¶œí–ˆìŠµë‹ˆë‹¤.\n\nğŸ’¡ **ë§ˆì¼€íŒ… ë¯¹ìŠ¤:**\nâ€¢ ì œí’ˆ/ì„œë¹„ìŠ¤ ìµœì í™”\nâ€¢ ê°€ê²© ì „ëµ ìˆ˜ë¦½\nâ€¢ í”„ë¡œëª¨ì…˜ ê¸°íš\n\nâ­ **ì„±ê³µ íŒ:**\nê³ ê°ì˜ ë§ˆìŒì„ ì›€ì§ì´ëŠ” ê²ƒì´ ìµœê³ ì˜ ë§ˆì¼€íŒ…ì…ë‹ˆë‹¤!",
        ]
        return random.choice(responses)

    def _medical_expert_response(self, question: str, info: dict) -> str:
        """ì˜ë£Œ ë„ê¹¨ë¹„ ì „ë¬¸ ì‘ë‹µ"""
        responses = [
            f"{info['emoji']} ì•ˆë…•í•˜ì„¸ìš”! {info['name']}ì…ë‹ˆë‹¤.\n\nê±´ê°• ê´€ë ¨ ì •ë³´ë¥¼ ì œê³µí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤:\n\nâš•ï¸ **ê±´ê°• ì²´í¬:**\n'{question}'ì— ëŒ€í•œ ì˜í•™ì  ê´€ì ì„ ì„¤ëª…ë“œë¦½ë‹ˆë‹¤.\n\nğŸ©º **ì£¼ìš” í¬ì¸íŠ¸:**\nâ€¢ ì¦ìƒ ì´í•´ ë° ì›ì¸ ë¶„ì„\nâ€¢ ì˜ˆë°©ë²• ë° ê´€ë¦¬ë²•\nâ€¢ ì „ë¬¸ì˜ ìƒë‹´ ê¶Œìœ \n\nâš ï¸ **ì¤‘ìš” ì•ˆë‚´:**\nì •í™•í•œ ì§„ë‹¨ì€ ë°˜ë“œì‹œ ì˜ë£Œì§„ê³¼ ìƒë‹´í•˜ì„¸ìš”!",
            f"{info['emoji']} {info['name']}ê°€ ê±´ê°• ì •ë³´ë¥¼ ì•ˆë‚´í•©ë‹ˆë‹¤!\n\nğŸ’Š **ì˜í•™ì  ì¡°ì–¸:**\n'{question}'ì— ëŒ€í•œ ì¼ë°˜ì ì¸ ì˜í•™ ì •ë³´ë¥¼ ì œê³µí•©ë‹ˆë‹¤.\n\nğŸ¥ **ê±´ê°• ê´€ë¦¬:**\nâ€¢ ìƒí™œìŠµê´€ ê°œì„  ë°©ë²•\nâ€¢ ì •ê¸° ê±´ê°•ê²€ì§„ ì¤‘ìš”ì„±\nâ€¢ ì‘ê¸‰ìƒí™© ëŒ€ì²˜ë²•\n\nğŸ’ **ê±´ê°• ë©”ì‹œì§€:**\nê±´ê°•í•œ ìƒí™œì´ ìµœê³ ì˜ ì¹˜ë£Œë²•ì…ë‹ˆë‹¤!",
        ]
        return random.choice(responses)

    def _sales_expert_response(self, question: str, info: dict) -> str:
        """ì˜ì—… ë„ê¹¨ë¹„ ì „ë¬¸ ì‘ë‹µ"""
        responses = [
            f"{info['emoji']} ì•ˆë…•í•˜ì„¸ìš”! {info['name']}ì…ë‹ˆë‹¤.\n\nì˜ì—… ì„±ê³¼ í–¥ìƒ ì „ëµì„ ì œì‹œí•˜ê² ìŠµë‹ˆë‹¤:\n\nğŸ’¼ **ì˜ì—… ë¶„ì„:**\n'{question}'ì— ëŒ€í•œ ì„¸ì¼ì¦ˆ ì†”ë£¨ì…˜ì„ ì œê³µí•©ë‹ˆë‹¤.\n\nğŸ¯ **ì„±ê³µ í¬ì¸íŠ¸:**\nâ€¢ ê³ ê° ë‹ˆì¦ˆ íŒŒì•…\nâ€¢ ì‹ ë¢° ê´€ê³„ êµ¬ì¶•\nâ€¢ ê°€ì¹˜ ì œì•ˆ ê°•í™”\n\nğŸ“ˆ **ì‹¤í–‰ ì „ëµ:**\nê³ ê° ì¤‘ì‹¬ ì‚¬ê³ ë¡œ ë§¤ì¶œì„ ê·¹ëŒ€í™”í•˜ì„¸ìš”!",
            f"{info['emoji']} {info['name']}ê°€ ì˜ì—… ë…¸í•˜ìš°ë¥¼ ì „ìˆ˜í•©ë‹ˆë‹¤!\n\nğŸ¤ **ê´€ê³„ êµ¬ì¶•:**\n'{question}'ì„ í†µí•´ ê³ ê°ê³¼ì˜ ì—°ê²°ì ì„ ì°¾ì•˜ìŠµë‹ˆë‹¤.\n\nğŸ’° **ë§¤ì¶œ ì¦ëŒ€:**\nâ€¢ ì˜ì—… í”„ë¡œì„¸ìŠ¤ ìµœì í™”\nâ€¢ ì„±ê³¼ ì¸¡ì • ì‹œìŠ¤í…œ\nâ€¢ íŒ€ì›Œí¬ ê°•í™”\n\nğŸ† **ì„±ê³µ ë¹„ë²•:**\nì§„ì •ì„± ìˆëŠ” ì„œë¹„ìŠ¤ê°€ ìµœê³ ì˜ ì˜ì—…ë ¥ì…ë‹ˆë‹¤!",
        ]
        return random.choice(responses)

    def _seo_expert_response(self, question: str, info: dict) -> str:
        """SEO ë„ê¹¨ë¹„ ì „ë¬¸ ì‘ë‹µ"""
        responses = [
            f"{info['emoji']} ì•ˆë…•í•˜ì„¸ìš”! {info['name']}ì…ë‹ˆë‹¤.\n\nê²€ìƒ‰ ìµœì í™” ì „ëµì„ ì œê³µí•˜ê² ìŠµë‹ˆë‹¤:\n\nğŸ” **SEO ë¶„ì„:**\n'{question}'ì— ëŒ€í•œ ê²€ìƒ‰ì—”ì§„ ìµœì í™” ë°©ì•ˆì…ë‹ˆë‹¤.\n\nğŸ“ˆ **í•µì‹¬ ì „ëµ:**\nâ€¢ í‚¤ì›Œë“œ ìµœì í™”\nâ€¢ ì½˜í…ì¸  í’ˆì§ˆ í–¥ìƒ\nâ€¢ ë°±ë§í¬ êµ¬ì¶•\n\nâš¡ **ì‹¤í–‰ ê³„íš:**\nêµ¬ê¸€ ìƒìœ„ ë…¸ì¶œë¡œ íŠ¸ë˜í”½ì„ ì¦ê°€ì‹œí‚¤ì„¸ìš”!",
            f"{info['emoji']} {info['name']}ê°€ SEO ë¹„ë²•ì„ ì•Œë ¤ë“œë¦½ë‹ˆë‹¤!\n\nğŸŒ **ì›¹ ìµœì í™”:**\n'{question}'ì„ ë°”íƒ•ìœ¼ë¡œ ê²€ìƒ‰ ìˆœìœ„ í–¥ìƒ ë°©ë²•ì„ ì œì‹œí•©ë‹ˆë‹¤.\n\nğŸ¯ **ìµœì í™” í¬ì¸íŠ¸:**\nâ€¢ ê¸°ìˆ ì  SEO ê°œì„ \nâ€¢ ì‚¬ìš©ì ê²½í—˜ í–¥ìƒ\nâ€¢ ëª¨ë°”ì¼ ìµœì í™”\n\nğŸš€ **ì„±ê³¼ ì˜ˆì¸¡:**\nì²´ê³„ì ì¸ SEOë¡œ ìœ ê¸°ì  íŠ¸ë˜í”½ì„ ëŠ˜ë ¤ë³´ì„¸ìš”!",
        ]
        return random.choice(responses)

    def _shopping_expert_response(self, question: str, info: dict) -> str:
        """ì‡¼í•‘ ë„ê¹¨ë¹„ ì „ë¬¸ ì‘ë‹µ"""
        responses = [
            f"{info['emoji']} ì•ˆë…•í•˜ì„¸ìš”! {info['name']}ì…ë‹ˆë‹¤.\n\nìŠ¤ë§ˆíŠ¸í•œ ì‡¼í•‘ ê°€ì´ë“œë¥¼ ì œê³µí•˜ê² ìŠµë‹ˆë‹¤:\n\nğŸ›ï¸ **ì‡¼í•‘ ë¶„ì„:**\n'{question}'ì— ëŒ€í•œ ìµœì ì˜ êµ¬ë§¤ ì¡°ì–¸ì„ ë“œë¦½ë‹ˆë‹¤.\n\nğŸ’¡ **ì‡¼í•‘ íŒ:**\nâ€¢ ê°€ê²© ë¹„êµ ë° í• ì¸ ì •ë³´\nâ€¢ ì œí’ˆ í’ˆì§ˆ í‰ê°€\nâ€¢ êµ¬ë§¤ íƒ€ì´ë° ìµœì í™”\n\nğŸ’° **ì ˆì•½ ë°©ë²•:**\ní˜„ëª…í•œ ì†Œë¹„ë¡œ ë§Œì¡±ë„ë¥¼ ê·¹ëŒ€í™”í•˜ì„¸ìš”!",
            f"{info['emoji']} {info['name']}ê°€ ì‡¼í•‘ ì»¨ì„¤íŒ…ì„ í•´ë“œë¦½ë‹ˆë‹¤!\n\nğŸª **êµ¬ë§¤ ì „ëµ:**\n'{question}'ì— ë§ëŠ” ìµœê³ ì˜ ì‡¼í•‘ ì†”ë£¨ì…˜ì„ ì°¾ì•˜ìŠµë‹ˆë‹¤.\n\nğŸ **ì¶”ì²œ í¬ì¸íŠ¸:**\nâ€¢ ë¸Œëœë“œë³„ íŠ¹ì„± ë¶„ì„\nâ€¢ ë¦¬ë·° ë° í‰ì  ê²€í† \nâ€¢ ì• í”„í„°ì„œë¹„ìŠ¤ ê³ ë ¤\n\nâœ¨ **ë§Œì¡± ë³´ì¥:**\ní•©ë¦¬ì ì¸ ì†Œë¹„ê°€ ì§„ì •í•œ í–‰ë³µì„ ê°€ì ¸ë‹¤ì¤ë‹ˆë‹¤!",
        ]
        return random.choice(responses)

    def _startup_expert_response(self, question: str, info: dict) -> str:
        """ìŠ¤íƒ€íŠ¸ì—… ë„ê¹¨ë¹„ ì „ë¬¸ ì‘ë‹µ"""
        responses = [
            f"{info['emoji']} ì•ˆë…•í•˜ì„¸ìš”! {info['name']}ì…ë‹ˆë‹¤.\n\nì°½ì—… ì„±ê³µ ì „ëµì„ ì œì‹œí•˜ê² ìŠµë‹ˆë‹¤:\n\nğŸš€ **ìŠ¤íƒ€íŠ¸ì—… ë¶„ì„:**\n'{question}'ì— ëŒ€í•œ ì°½ì—… ë¡œë“œë§µì„ ì œê³µí•©ë‹ˆë‹¤.\n\nğŸ’¡ **í•µì‹¬ í¬ì¸íŠ¸:**\nâ€¢ ì‹œì¥ ê²€ì¦ ë° PMF\nâ€¢ íŒ€ ë¹Œë”© ë° ë¬¸í™”\nâ€¢ ìê¸ˆ ì¡°ë‹¬ ì „ëµ\n\nğŸ† **ì„±ê³µ ë¹„ê²°:**\nê³ ê° ë¬¸ì œ í•´ê²°ì— ì§‘ì¤‘í•˜ë©´ ì„±ê³µí•©ë‹ˆë‹¤!",
            f"{info['emoji']} {info['name']}ê°€ ì°½ì—… ë©˜í† ë§ì„ ì œê³µí•©ë‹ˆë‹¤!\n\nğŸ’¼ **ë¹„ì¦ˆë‹ˆìŠ¤ ëª¨ë¸:**\n'{question}'ì„ í†µí•´ ì§€ì† ê°€ëŠ¥í•œ ì‚¬ì—… êµ¬ì¡°ë¥¼ ì„¤ê³„í–ˆìŠµë‹ˆë‹¤.\n\nğŸ“Š **ì‹¤í–‰ ê³„íš:**\nâ€¢ MVP ê°œë°œ ë° í…ŒìŠ¤íŠ¸\nâ€¢ ë§ˆì¼€íŒ… ì „ëµ ìˆ˜ë¦½\nâ€¢ ì„±ì¥ ì§€í‘œ ê´€ë¦¬\n\nğŸŒŸ **ì°½ì—… ì •ì‹ :**\nì‹¤íŒ¨ë¥¼ ë‘ë ¤ì›Œí•˜ì§€ ë§ê³  ê³„ì† ë„ì „í•˜ì„¸ìš”!",
        ]
        return random.choice(responses)

    def _village_chief_expert_response(self, question: str, info: dict) -> str:
        """ì´ì¥ ë„ê¹¨ë¹„ ì „ë¬¸ ì‘ë‹µ"""
        responses = [
            f"{info['emoji']} ì•ˆë…•í•˜ì„¸ìš”! {info['name']}ì…ë‹ˆë‹¤.\n\në§ˆì„ ê´€ë¦¬ ì „ë¬¸ê°€ë¡œì„œ ì¡°ì–¸ë“œë¦¬ê² ìŠµë‹ˆë‹¤:\n\nğŸ˜ï¸ **ì»¤ë®¤ë‹ˆí‹° ë¶„ì„:**\n'{question}'ì— ëŒ€í•œ ì¢…í•©ì ì¸ ê´€ë¦¬ ë°©ì•ˆì„ ì œì‹œí•©ë‹ˆë‹¤.\n\nğŸ‘¥ **ê´€ë¦¬ í¬ì¸íŠ¸:**\nâ€¢ ì£¼ë¯¼ ì†Œí†µ ë° í™”í•©\nâ€¢ ì¸í”„ë¼ ê°œì„  ê³„íš\nâ€¢ ì§€ì† ê°€ëŠ¥í•œ ë°œì „\n\nğŸŒŸ **ë¦¬ë”ì‹­ ì² í•™:**\nëª¨ë“  êµ¬ì„±ì›ì´ í–‰ë³µí•œ ê³µë™ì²´ë¥¼ ë§Œë“¤ì–´ê°€ê² ìŠµë‹ˆë‹¤!",
            f"{info['emoji']} {info['name']}ê°€ í˜„ëª…í•œ í•´ê²°ì±…ì„ ì œì‹œí•©ë‹ˆë‹¤!\n\nğŸ¯ **í†µí•© ê´€ë¦¬:**\n'{question}'ì„ ë°”íƒ•ìœ¼ë¡œ ì „ì²´ì ì¸ ìš´ì˜ ë°©ì•ˆì„ ìˆ˜ë¦½í–ˆìŠµë‹ˆë‹¤.\n\nğŸ“‹ **ì‹¤í–‰ ê³„íš:**\nâ€¢ íš¨ìœ¨ì  ìì› ë°°ë¶„\nâ€¢ ê°ˆë“± ì¡°ì • ë° í•´ê²°\nâ€¢ ë¯¸ë˜ ë¹„ì „ ìˆ˜ë¦½\n\nğŸ¤ **í˜‘ë ¥ ì •ì‹ :**\ní•¨ê»˜ ë§Œë“¤ì–´ê°€ëŠ” ê²ƒì´ ê°€ì¥ ê°•ë ¥í•œ í˜ì…ë‹ˆë‹¤!",
        ]
        return random.choice(responses)

    def _writing_expert_response(self, question: str, info: dict) -> str:
        """ë°•ì‚¬ê¸‰ ë¬¸ì„œ ì‘ì„± ë„ê¹¨ë¹„ ì „ë¬¸ ì‘ë‹µ"""
        responses = [
            f"{info['emoji']} ì•ˆë…•í•˜ì„¸ìš”! {info['name']}ì…ë‹ˆë‹¤.\n\nì „ë¬¸ì ì¸ ë¬¸ì„œ ì‘ì„±ì„ ë„ì™€ë“œë¦¬ê² ìŠµë‹ˆë‹¤:\n\nğŸ“ **ë¬¸ì„œ ë¶„ì„:**\n'{question}'ì— ëŒ€í•œ ê³ í’ˆì§ˆ ë¬¸ì„œ ì‘ì„± ê°€ì´ë“œë¥¼ ì œê³µí•©ë‹ˆë‹¤.\n\nâœï¸ **ì‘ì„± í¬ì¸íŠ¸:**\nâ€¢ ë…¼ë¦¬ì  êµ¬ì¡° ì„¤ê³„\nâ€¢ ëª…í™•í•œ í‘œí˜„ ê¸°ë²•\nâ€¢ ë…ì ë§ì¶¤ ìŠ¤íƒ€ì¼\n\nğŸ“š **í’ˆì§ˆ í–¥ìƒ:**\nì²´ê³„ì ì¸ ê¸€ì“°ê¸°ë¡œ ì „ë¬¸ì„±ì„ ë³´ì—¬ì£¼ì„¸ìš”!",
            f"{info['emoji']} {info['name']}ê°€ ë¬¸ì„œ ì‘ì„± ì „ë¬¸ê°€ë¡œ ë„ì›€ë“œë¦½ë‹ˆë‹¤!\n\nğŸ“– **ë¼ì´íŒ… ì „ëµ:**\n'{question}'ì— ë§ëŠ” íš¨ê³¼ì ì¸ ê¸€ì“°ê¸° ë°©ë²•ì„ ì•ˆë‚´í•©ë‹ˆë‹¤.\n\nğŸ¯ **í•µì‹¬ ê¸°ë²•:**\nâ€¢ ëª©ì ì— ë§ëŠ” í†¤ì•¤ë§¤ë„ˆ\nâ€¢ ì„¤ë“ë ¥ ìˆëŠ” ë…¼ì¦\nâ€¢ ê°€ë…ì„± ìµœì í™”\n\nâ­ **ë¬¸ì„œ ì™„ì„±ë„:**\nì™„ë²½í•œ ë¬¸ì„œë¡œ ì›í•˜ëŠ” ê²°ê³¼ë¥¼ ì–»ìœ¼ì‹¤ ìˆ˜ ìˆìŠµë‹ˆë‹¤!",
        ]
        return random.choice(responses)

    def _general_expert_response(self, question: str, info: dict) -> str:
        """ì¼ë°˜ ì „ë¬¸ê°€ ì‘ë‹µ (ìƒˆë¡œìš´ ë„ê¹¨ë¹„ íƒ€ì…ìš©)"""
        return f"{info['emoji']} ì•ˆë…•í•˜ì„¸ìš”! {info['name']}ì…ë‹ˆë‹¤.\n\n'{question}'ì— ëŒ€í•´ {info['field']} ì „ë¬¸ê°€ë¡œì„œ ë„ì›€ì„ ë“œë¦¬ê² ìŠµë‹ˆë‹¤.\n\nğŸ” **ì „ë¬¸ ë¶„ì„:**\ní•´ë‹¹ ë¶„ì•¼ì˜ ê¹Šì´ ìˆëŠ” ì§€ì‹ì„ ë°”íƒ•ìœ¼ë¡œ ë§ì¶¤í˜• ì†”ë£¨ì…˜ì„ ì œê³µí•˜ê² ìŠµë‹ˆë‹¤.\n\nğŸ’¡ **ì‹¤ìš©ì  ì¡°ì–¸:**\nì´ë¡ ê³¼ ì‹¤ë¬´ë¥¼ ê²°í•©í•œ ì‹¤í–‰ ê°€ëŠ¥í•œ ë°©ì•ˆì„ ì œì‹œí•˜ê² ìŠµë‹ˆë‹¤.\n\nâœ¨ **ê¸°ëŒ€ íš¨ê³¼:**\nì „ë¬¸ì ì¸ ì ‘ê·¼ìœ¼ë¡œ ìµœì ì˜ ê²°ê³¼ë¥¼ ë§Œë“¤ì–´ë³´ì„¸ìš”!"

    def get_agent_info(self) -> Dict[str, Any]:
        """ë„ê¹¨ë¹„ ì •ë³´ ë°˜í™˜ (í”„ë¡ íŠ¸ì—”ë“œìš©)"""
        agent_info = {
            "assistant": {
                "emoji": "ğŸ¤–",
                "name": "ë°•ì‚¬ê¸‰ ë¹„ì„œ ë„ê¹¨ë¹„",
                "field": "ì—…ë¬´ ê´€ë¦¬",
            },
            "builder": {"emoji": "ğŸ’»", "name": "ë¹Œë” ë„ê¹¨ë¹„", "field": "ê°œë°œ"},
            "counselor": {"emoji": "ğŸ’¬", "name": "ìƒë‹´ ë„ê¹¨ë¹„", "field": "ìƒë‹´"},
            "creative": {"emoji": "ğŸ¨", "name": "ì°½ì‘ ë„ê¹¨ë¹„", "field": "ì°½ì‘"},
            "data_analyst": {
                "emoji": "ğŸ“Š",
                "name": "ë°ì´í„°ë¶„ì„ ë„ê¹¨ë¹„",
                "field": "ë°ì´í„° ë¶„ì„",
            },
            "fortune": {"emoji": "ğŸ”®", "name": "ìš´ì„¸ ë„ê¹¨ë¹„", "field": "ìš´ì„¸"},
            "growth": {"emoji": "ğŸŒ±", "name": "ì„±ì¥ ë„ê¹¨ë¹„", "field": "ì„±ì¥"},
            "hr": {"emoji": "ğŸ‘¥", "name": "HR ë„ê¹¨ë¹„", "field": "ì¸ì‚¬ ê´€ë¦¬"},
            "marketing": {"emoji": "ğŸ“ˆ", "name": "ë§ˆì¼€íŒ… ë„ê¹¨ë¹„", "field": "ë§ˆì¼€íŒ…"},
            "medical": {"emoji": "ğŸ¥", "name": "ì˜ë£Œ ë„ê¹¨ë¹„", "field": "ì˜ë£Œ"},
            "sales": {"emoji": "ğŸ’°", "name": "ì˜ì—… ë„ê¹¨ë¹„", "field": "ì˜ì—…"},
            "seo": {"emoji": "ğŸ”", "name": "SEO ë„ê¹¨ë¹„", "field": "ê²€ìƒ‰ ìµœì í™”"},
            "shopping": {"emoji": "ğŸ›’", "name": "ì‡¼í•‘ ë„ê¹¨ë¹„", "field": "ì‡¼í•‘"},
            "startup": {"emoji": "ğŸš€", "name": "ìŠ¤íƒ€íŠ¸ì—… ë„ê¹¨ë¹„", "field": "ì°½ì—…"},
            "village_chief": {
                "emoji": "ğŸ‘‘",
                "name": "ì´ì¥ ë„ê¹¨ë¹„",
                "field": "ë§ˆì„ ê´€ë¦¬",
            },
            "writing": {
                "emoji": "âœï¸",
                "name": "ë°•ì‚¬ê¸‰ ë¬¸ì„œ ì‘ì„± ë„ê¹¨ë¹„",
                "field": "ë¬¸ì„œ ì‘ì„±",
            },
        }

        return {
            "total_agents": len(agent_info),
            "agents": agent_info,
            "categories": {
                "ì—…ë¬´&ê´€ë¦¬": ["assistant", "hr", "village_chief", "growth"],
                "ì°½ì‘&ë§ˆì¼€íŒ…": ["creative", "marketing", "writing", "seo"],
                "ê¸°ìˆ &ë¶„ì„": ["builder", "data_analyst", "medical", "startup"],
                "ìƒí™œ&ìƒë‹´": ["counselor", "fortune", "sales", "shopping"],
            },
        }


# ì „ì—­ ì¸ìŠ¤í„´ìŠ¤
stem_ai = STEMIntegration()


def add_stem_routes(app):
    """FastAPI ì•±ì— STEM ë¼ìš°íŠ¸ ì¶”ê°€"""
    from fastapi import Request
    from fastapi.responses import HTMLResponse
    
    @app.post("/stem/chat")
    async def stem_chat(request: Request):
        """STEM ë„ê¹¨ë¹„ì™€ ì±„íŒ…"""
        try:
            data = await request.json()
            agent_type = data.get("agent_type")
            question = data.get("question")
            user_ip = request.client.host if request.client else "unknown"
            
            result = stem_ai.process_question(agent_type, question, user_ip)
            return result
        except Exception as e:
            return {"success": False, "error": f"ì„œë²„ ì˜¤ë¥˜: {str(e)}"}

    @app.get("/stem/info")
    async def stem_info():
        """STEM ë„ê¹¨ë¹„ ì •ë³´ ì¡°íšŒ"""
        return stem_ai.get_agent_info()

    @app.get("/stem/stats")
    async def stem_stats():
        """STEM ì‚¬ìš© í†µê³„ ì¡°íšŒ"""
        try:
            from usage_tracker import usage_tracker
            return usage_tracker.get_statistics()
        except Exception as e:
            return {"error": f"í†µê³„ ì¡°íšŒ ì‹¤íŒ¨: {str(e)}"}

    @app.get("/stem", response_class=HTMLResponse)
    async def stem_page():
        """STEM ë„ê¹¨ë¹„ ë©”ì¸ í˜ì´ì§€"""
        try:
            with open("index_stem.html", "r", encoding="utf-8") as f:
                return f.read()
        except FileNotFoundError:
            return "<h1>STEM í˜ì´ì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤</h1>"
