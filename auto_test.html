<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸ¤– 16ëª… ì „ë¬¸ê°€ ìë™ í…ŒìŠ¤íŠ¸</title>
    <style>
        body {
            font-family: 'Malgun Gothic', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            margin: 0;
            padding: 20px;
            color: white;
        }
        .container {
            max-width: 1200px;
            margin: 0 auto;
            background: rgba(255,255,255,0.1);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 30px;
        }
        .title {
            text-align: center;
            font-size: 2.5em;
            margin-bottom: 30px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }
        .controls {
            text-align: center;
            margin-bottom: 30px;
        }
        .btn {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            border: none;
            color: white;
            padding: 15px 30px;
            font-size: 18px;
            border-radius: 25px;
            cursor: pointer;
            margin: 5px;
            transition: all 0.3s;
        }
        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        }
        .progress {
            background: rgba(255,255,255,0.2);
            border-radius: 10px;
            padding: 10px;
            margin: 20px 0;
            text-align: center;
        }
        .expert-result {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            margin: 15px 0;
            border-left: 5px solid #4ecdc4;
        }
        .expert-name {
            font-size: 1.3em;
            font-weight: bold;
            margin-bottom: 15px;
        }
        .question-result {
            background: rgba(255,255,255,0.1);
            border-radius: 10px;
            padding: 15px;
            margin: 10px 0;
        }
        .success { border-left-color: #2ecc71; }
        .error { border-left-color: #e74c3c; }
        .stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-top: 30px;
        }
        .stat-card {
            background: rgba(255,255,255,0.1);
            border-radius: 15px;
            padding: 20px;
            text-align: center;
        }
        .stat-number {
            font-size: 2em;
            font-weight: bold;
            color: #4ecdc4;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="title">ğŸ¤– 16ëª… ë°•ì‚¬ê¸‰ ì „ë¬¸ê°€ ìë™ í…ŒìŠ¤íŠ¸</h1>
        
        <div class="controls">
            <button class="btn" onclick="startQuickTest()">ğŸš€ ë¹ ë¥¸ í…ŒìŠ¤íŠ¸ (5ëª…)</button>
            <button class="btn" onclick="startFullTest()">ğŸ”¥ ì „ì²´ í…ŒìŠ¤íŠ¸ (16ëª…)</button>
            <button class="btn" onclick="clearResults()">ğŸ—‘ï¸ ê²°ê³¼ ì´ˆê¸°í™”</button>
        </div>
        
        <div class="progress" id="progress" style="display:none;">
            <div id="progressText">í…ŒìŠ¤íŠ¸ ì¤€ë¹„ ì¤‘...</div>
            <div id="progressBar" style="background: #4ecdc4; height: 10px; border-radius: 5px; width: 0%; margin-top: 10px; transition: width 0.3s;"></div>
        </div>
        
        <div id="results"></div>
        
        <div class="stats" id="stats" style="display:none;">
            <div class="stat-card">
                <div class="stat-number" id="totalQuestions">0</div>
                <div>ì´ ì§ˆë¬¸ ìˆ˜</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="successRate">0%</div>
                <div>ì„±ê³µë¥ </div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="avgQuality">0</div>
                <div>í‰ê·  í’ˆì§ˆ</div>
            </div>
            <div class="stat-card">
                <div class="stat-number" id="totalTime">0s</div>
                <div>ì´ ì†Œìš”ì‹œê°„</div>
            </div>
        </div>
    </div>

    <script>
        const experts = {
            medical: { name: "ì˜í•™ë°•ì‚¬ í•˜ì´ì§„ ğŸ¥", questions: ["ë‹¹ë‡¨ í™˜ìì˜ í˜ˆë‹¹ ê´€ë¦¬ ì‹ë‹¨ 3ê°€ì§€ í•µì‹¬ ì›ì¹™ì€?", "ê³ í˜ˆì•• 140/90ì—ì„œ ì•½ë¬¼ ì—†ì´ ê°œì„ í•˜ëŠ” ë°©ë²•?"] },
            financial: { name: "ê²½ì œí•™ë°•ì‚¬ ë¶€ìì§„ ğŸ’°", questions: ["ì›”ê¸‰ 300ë§Œì›ìœ¼ë¡œ ì£¼íƒì²­ì•½ê³¼ ì£¼ì‹íˆ¬ì ë¹„ìœ¨ ì¶”ì²œ?", "ISAê³„ì¢Œ vs ì—°ê¸ˆì €ì¶• ì„¸ì œí˜œíƒ ë¹„êµ ë¶„ì„?"] },
            tech: { name: "ê³µí•™ë°•ì‚¬ í…Œí¬ì§„ ğŸ”§", questions: ["ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ì—ì„œ API Gateway vs Service Mesh ì°¨ì´ì ?", "React 18 Concurrent Features ì‹¤ë¬´ í™œìš©ë²•?"] },
            creative: { name: "ì˜ˆìˆ í•™ë°•ì‚¬ ì°½ì‘ì§„ ğŸ¨", questions: ["ë¸Œëœë“œ ë¡œê³  ë””ìì¸ì‹œ ìƒ‰ì±„ ì‹¬ë¦¬í•™ í™œìš©ë²•?", "ì†Œì„¤ í”Œë¡¯ì˜ 3ë§‰ êµ¬ì¡°ì™€ ê°ˆë“± ì„¤ì • ë°©ë²•?"] },
            marketing: { name: "ë§ˆì¼€íŒ…ë°•ì‚¬ ë§ˆì§„ ğŸ“ˆ", questions: ["Zì„¸ëŒ€ íƒ€ê²Ÿ SNS ë§ˆì¼€íŒ… í”Œë«í¼ë³„ ì „ëµ?", "B2B ì˜ì—…ì—ì„œ ê³ ê° í˜ì¸í¬ì¸íŠ¸ ë°œêµ´ ë°©ë²•?"] }
        };

        const allExperts = {
            medical: { name: "ì˜í•™ë°•ì‚¬ í•˜ì´ì§„ ğŸ¥", questions: ["ë‹¹ë‡¨ í™˜ìì˜ í˜ˆë‹¹ ê´€ë¦¬ ì‹ë‹¨ 3ê°€ì§€ í•µì‹¬ ì›ì¹™ì€?", "ê³ í˜ˆì•• 140/90ì—ì„œ ì•½ë¬¼ ì—†ì´ ê°œì„ í•˜ëŠ” ë°©ë²•?", "ê°±ë…„ê¸° ì—¬ì„±ì˜ í˜¸ë¥´ëª¬ ë³€í™”ì™€ ëŒ€ì²˜ë²•ì€?"] },
            financial: { name: "ê²½ì œí•™ë°•ì‚¬ ë¶€ìì§„ ğŸ’°", questions: ["ì›”ê¸‰ 300ë§Œì›ìœ¼ë¡œ ì£¼íƒì²­ì•½ê³¼ ì£¼ì‹íˆ¬ì ë¹„ìœ¨ ì¶”ì²œ?", "ISAê³„ì¢Œ vs ì—°ê¸ˆì €ì¶• ì„¸ì œí˜œíƒ ë¹„êµ ë¶„ì„?", "ì¸í”Œë ˆì´ì…˜ ì‹œëŒ€ ìì‚°ë°°ë¶„ ì „ëµì€?"] },
            legal: { name: "ë²•í•™ë°•ì‚¬ ë¡œì§„ âš–ï¸", questions: ["ì„ëŒ€ì°¨ ë³´ì¦ê¸ˆ ë°˜í™˜ ê±°ë¶€ì‹œ ë²•ì  ëŒ€ì‘ ì ˆì°¨?", "ì§ì¥ ë‚´ ì„±í¬ë¡± í”¼í•´ ì‹œ ì¦ê±° ìˆ˜ì§‘ê³¼ ì‹ ê³  ë°©ë²•?"] },
            tech: { name: "ê³µí•™ë°•ì‚¬ í…Œí¬ì§„ ğŸ”§", questions: ["ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ì—ì„œ API Gateway vs Service Mesh ì°¨ì´ì ?", "React 18 Concurrent Features ì‹¤ë¬´ í™œìš©ë²•?", "Docker ì»¨í…Œì´ë„ˆ ë³´ì•ˆ ê°•í™” 5ê°€ì§€ ë°©ë²•?"] },
            creative: { name: "ì˜ˆìˆ í•™ë°•ì‚¬ ì°½ì‘ì§„ ğŸ¨", questions: ["ë¸Œëœë“œ ë¡œê³  ë””ìì¸ì‹œ ìƒ‰ì±„ ì‹¬ë¦¬í•™ í™œìš©ë²•?", "ì†Œì„¤ í”Œë¡¯ì˜ 3ë§‰ êµ¬ì¡°ì™€ ê°ˆë“± ì„¤ì • ë°©ë²•?"] },
            marketing: { name: "ë§ˆì¼€íŒ…ë°•ì‚¬ ë§ˆì§„ ğŸ“ˆ", questions: ["Zì„¸ëŒ€ íƒ€ê²Ÿ SNS ë§ˆì¼€íŒ… í”Œë«í¼ë³„ ì „ëµ?", "B2B ì˜ì—…ì—ì„œ ê³ ê° í˜ì¸í¬ì¸íŠ¸ ë°œêµ´ ë°©ë²•?"] },
            education: { name: "êµìœ¡í•™ë°•ì‚¬ ê°€ë¥´ì§„ ğŸ“", questions: ["ì„±ì¸ í•™ìŠµìì˜ ê¸°ì–µë ¥ í–¥ìƒ í•™ìŠµë²• 3ê°€ì§€?", "ì˜¨ë¼ì¸ ê°•ì˜ì—ì„œ ì§‘ì¤‘ë ¥ ìœ ì§€í•˜ëŠ” ë°©ë²•?"] },
            hr: { name: "ì¸ì‚¬ê´€ë¦¬ë°•ì‚¬ ì¸ì¬ì§„ ğŸ‘¥", questions: ["ë¦¬ëª¨íŠ¸ì›Œí¬ ì‹œëŒ€ íŒ€ ì„±ê³¼ í‰ê°€ ê¸°ì¤€?", "ì‹ ì…ì‚¬ì› ì˜¨ë³´ë”© í”„ë¡œê·¸ë¨ ì„¤ê³„ í•µì‹¬ ìš”ì†Œ?"] },
            sales: { name: "ê²½ì˜í•™ë°•ì‚¬ ì„¸ì¼ì§„ ğŸ’¼", questions: ["B2B ê³ ê°ì‚¬ ì˜ì‚¬ê²°ì •ì ì ‘ê·¼ ì „ëµ?", "ê±°ì ˆ ê³ ê°ì„ ì„¤ë“í•˜ëŠ” ë„¤ê³ ì‹œì—ì´ì…˜ ê¸°ë²•?"] },
            research: { name: "ì—°êµ¬ë°•ì‚¬ íƒêµ¬ì§„ ğŸ”¬", questions: ["ì •ì„± ì—°êµ¬ì™€ ì •ëŸ‰ ì—°êµ¬ì˜ í˜¼í•© ë°©ë²•ë¡  ì„¤ê³„?", "ì„¤ë¬¸ì¡°ì‚¬ ì‘ë‹µë¥  í–¥ìƒì„ ìœ„í•œ ì¸ì„¼í‹°ë¸Œ ì „ëµ?"] },
            translation: { name: "ì–¸ì–´í•™ë°•ì‚¬ ë²ˆì—­ì§„ ğŸŒ", questions: ["ê¸°ìˆ  ë¬¸ì„œ ë²ˆì—­ì‹œ ì „ë¬¸ìš©ì–´ ì¼ê´€ì„± ìœ ì§€ë²•?", "ë¬¸í™”ì  ë‰˜ì•™ìŠ¤ê°€ ìˆëŠ” í‘œí˜„ì˜ í˜„ì§€í™” ì „ëµ?"] },
            consulting: { name: "ì»¨ì„¤íŒ…ë°•ì‚¬ ì¡°ì–¸ì§„ ğŸ’¡", questions: ["ì¤‘ì†Œê¸°ì—… ë””ì§€í„¸ ì „í™˜ ë¡œë“œë§µ ìˆ˜ë¦½ ë°©ë²•?", "ì¡°ì§ ë³€í™” ê´€ë¦¬ì—ì„œ ì €í•­ ê·¹ë³µ ì „ëµ?"] },
            psychology: { name: "ì‹¬ë¦¬í•™ë°•ì‚¬ ë§ˆìŒì§„ ğŸ§ ", questions: ["ì§ì¥ ìŠ¤íŠ¸ë ˆìŠ¤ë¡œ ì¸í•œ ë²ˆì•„ì›ƒ ì˜ˆë°©ë²•?", "ëŒ€ì¸ê´€ê³„ì—ì„œ ê²½ê³„ ì„¤ì •í•˜ëŠ” ë°©ë²•?"] },
            data: { name: "ë°ì´í„°ë°•ì‚¬ ë¶„ì„ì§„ ğŸ“Š", questions: ["ë¨¸ì‹ ëŸ¬ë‹ ëª¨ë¸ì˜ ê³¼ì í•© ë°©ì§€ ì „ëµ?", "A/B í…ŒìŠ¤íŠ¸ ì„¤ê³„ì‹œ í†µê³„ì  ìœ ì˜ì„± í™•ë³´ë²•?"] },
            startup: { name: "ì°½ì—…ë°•ì‚¬ ë²¤ì²˜ì§„ ğŸš€", questions: ["ìŠ¤íƒ€íŠ¸ì—… ì´ˆê¸° íŒ€ êµ¬ì„±ê³¼ ì§€ë¶„ ë°°ë¶„ ì›ì¹™?", "MVP ê°œë°œí›„ ì‹œì¥ ê²€ì¦ ë°©ë²•ë¡ ?"] },
            wellness: { name: "ì›°ë‹ˆìŠ¤ë°•ì‚¬ ê±´ê°•ì§„ ğŸŒ¿", questions: ["í˜„ëŒ€ì¸ì˜ ìˆ˜ë©´ ì§ˆ í–¥ìƒì„ ìœ„í•œ ìƒí™œ ìŠµê´€?", "ìŠ¤ë§ˆíŠ¸í° ì¤‘ë… ì˜ˆë°©ê³¼ ë””ì§€í„¸ ë””í†¡ìŠ¤ ë°©ë²•?"] }
        };

        let testResults = [];
        let isTestRunning = false;

        async function askExpert(expertType, question) {
            try {
                const response = await fetch('/chat', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ agent_type: expertType, message: question })
                });
                
                if (response.ok) {
                    const result = await response.json();
                    return { success: true, response: result.response };
                } else {
                    return { success: false, error: `HTTP ${response.status}` };
                }
            } catch (error) {
                return { success: false, error: error.message };
            }
        }

        function evaluateQuality(response) {
            if (!response) return 0;
            let score = 5;
            if (response.length > 200) score += 1;
            if (response.length > 400) score += 1;
            const professionalWords = ['ì „ë¬¸ê°€', 'ì¶”ì²œ', 'ë°©ë²•', 'ì „ëµ', 'ë¶„ì„', 'ì¤‘ìš”', 'í•µì‹¬', 'íš¨ê³¼ì '];
            if (professionalWords.some(word => response.includes(word))) score += 1;
            const specificWords = ['ë‹¨ê³„', 'ì ˆì°¨', 'ê¸°ë²•', 'ì›ì¹™', 'ì¡°ê±´', 'ìš”ì†Œ', 'ì‚¬ë¡€', 'ì˜ˆì‹œ'];
            if (specificWords.some(word => response.includes(word))) score += 1;
            return Math.min(score, 10);
        }

        async function runTest(expertsToTest) {
            if (isTestRunning) return;
            isTestRunning = true;
            
            const progress = document.getElementById('progress');
            const progressText = document.getElementById('progressText');
            const progressBar = document.getElementById('progressBar');
            const results = document.getElementById('results');
            
            progress.style.display = 'block';
            results.innerHTML = '';
            
            let totalQuestions = 0;
            Object.values(expertsToTest).forEach(expert => totalQuestions += expert.questions.length);
            
            let currentQuestion = 0;
            const startTime = Date.now();
            testResults = [];
            
            for (const [expertType, expertData] of Object.entries(expertsToTest)) {
                const expertDiv = document.createElement('div');
                expertDiv.className = 'expert-result';
                expertDiv.innerHTML = `<div class="expert-name">${expertData.name}</div>`;
                results.appendChild(expertDiv);
                
                for (let i = 0; i < expertData.questions.length; i++) {
                    const question = expertData.questions[i];
                    currentQuestion++;
                    
                    progressText.textContent = `${expertData.name} - ì§ˆë¬¸ ${i+1}/${expertData.questions.length}`;
                    progressBar.style.width = `${(currentQuestion / totalQuestions) * 100}%`;
                    
                    const questionDiv = document.createElement('div');
                    questionDiv.className = 'question-result';
                    questionDiv.innerHTML = `<strong>ì§ˆë¬¸:</strong> ${question}<br><em>ì‘ë‹µ ëŒ€ê¸° ì¤‘...</em>`;
                    expertDiv.appendChild(questionDiv);
                    
                    const startQuestionTime = Date.now();
                    const result = await askExpert(expertType, question);
                    const questionTime = Date.now() - startQuestionTime;
                    
                    if (result.success) {
                        const quality = evaluateQuality(result.response);
                        questionDiv.className = 'question-result success';
                        questionDiv.innerHTML = `
                            <strong>ì§ˆë¬¸:</strong> ${question}<br>
                            <strong>ì‘ë‹µì‹œê°„:</strong> ${(questionTime/1000).toFixed(1)}ì´ˆ | <strong>í’ˆì§ˆ:</strong> ${quality}/10<br>
                            <strong>ì‘ë‹µ:</strong> ${result.response.substring(0, 200)}${result.response.length > 200 ? '...' : ''}
                        `;
                        testResults.push({ success: true, quality, time: questionTime });
                    } else {
                        questionDiv.className = 'question-result error';
                        questionDiv.innerHTML = `
                            <strong>ì§ˆë¬¸:</strong> ${question}<br>
                            <strong>ì˜¤ë¥˜:</strong> ${result.error}
                        `;
                        testResults.push({ success: false, time: questionTime });
                    }
                    
                    await new Promise(resolve => setTimeout(resolve, 500));
                }
            }
            
            const totalTime = Date.now() - startTime;
            progressText.textContent = 'í…ŒìŠ¤íŠ¸ ì™„ë£Œ!';
            progressBar.style.width = '100%';
            
            updateStats(totalTime);
            isTestRunning = false;
        }

        function updateStats(totalTime) {
            const stats = document.getElementById('stats');
            const successCount = testResults.filter(r => r.success).length;
            const successRate = testResults.length > 0 ? (successCount / testResults.length * 100) : 0;
            const avgQuality = successCount > 0 ? testResults.filter(r => r.success).reduce((sum, r) => sum + r.quality, 0) / successCount : 0;
            
            document.getElementById('totalQuestions').textContent = testResults.length;
            document.getElementById('successRate').textContent = `${successRate.toFixed(0)}%`;
            document.getElementById('avgQuality').textContent = avgQuality.toFixed(1);
            document.getElementById('totalTime').textContent = `${(totalTime/1000).toFixed(0)}s`;
            
            stats.style.display = 'grid';
        }

        function startQuickTest() {
            runTest(experts);
        }

        function startFullTest() {
            runTest(allExperts);
        }

        function clearResults() {
            document.getElementById('results').innerHTML = '';
            document.getElementById('progress').style.display = 'none';
            document.getElementById('stats').style.display = 'none';
            testResults = [];
        }
    </script>
</body>
</html>
