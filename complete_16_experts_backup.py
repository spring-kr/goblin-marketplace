"""
ì™„ì „í•œ 16ëª… ë°•ì‚¬ê¸‰ ì „ë¬¸ê°€ AI ì‹œìŠ¤í…œ
ì§„ì§œ ì „ë¬¸ê°€ ìˆ˜ì¤€ì˜ ì‘ë‹µì„ ìƒì„±í•˜ëŠ” ì‹œìŠ¤í…œ
"""

import re
import random
import json
from typing import Dict, Any, List
from datetime import datetime


class Complete16ExpertAI:
    """ì™„ì „í•œ 16ëª… ì „ë¬¸ê°€ AI ì‹œìŠ¤í…œ"""

    def __init__(self):
        self.expert_knowledge = self._load_all_16_experts()
        self.conversation_patterns = self._load_conversation_patterns()

    def _load_all_16_experts(self) -> Dict[str, Dict]:
        """16ëª… ì „ë¬¸ê°€ ì™„ì „ ë°ì´í„°ë² ì´ìŠ¤ - ì‹¤ì œ AI ìƒì„±"""
        return {
            "medical": {
                "name": "ì˜í•™ë°•ì‚¬ í•˜ì´ì§„", "emoji": "ğŸ¥",
                "title": "20ë…„ ê²½ë ¥ ì„ìƒì˜ì‚¬", 
                "expertise": ["ë‚´ê³¼", "ì™¸ê³¼", "ì‘ê¸‰ì˜í•™", "ì˜ˆë°©ì˜í•™", "ë‹¹ë‡¨", "ê³ í˜ˆì••", "ê°±ë…„ê¸°"],
                "knowledge_base": {
                    "ë‹¹ë‡¨": ["í˜ˆë‹¹ê´€ë¦¬", "ì‹ë‹¨ì¡°ì ˆ", "ìš´ë™ìš”ë²•", "ì•½ë¬¼ì¹˜ë£Œ", "í•©ë³‘ì¦ì˜ˆë°©"],
                    "ê³ í˜ˆì••": ["ìƒí™œìŠµê´€ê°œì„ ", "ì €ì—¼ì‹ì´", "ê·œì¹™ì ìš´ë™", "ìŠ¤íŠ¸ë ˆìŠ¤ê´€ë¦¬", "ê¸ˆì—°ê¸ˆì£¼"],
                    "ê°±ë…„ê¸°": ["í˜¸ë¥´ëª¬ë³€í™”", "ì¦ìƒì™„í™”", "ì˜ì–‘ê´€ë¦¬", "ìš´ë™ì²˜ë°©", "ì •ì‹ ê±´ê°•"]
                }
            },
            "financial": {
                "name": "ê²½ì œí•™ë°•ì‚¬ ë¶€ìì§„", "emoji": "ğŸ’°",
                "title": "25ë…„ ê²½ë ¥ íˆ¬ìì „ë¬¸ê°€",
                "expertise": ["íˆ¬ìì „ëµ", "í¬íŠ¸í´ë¦¬ì˜¤", "ì—°ê¸ˆì„¤ê³„", "ì„¸ë¬´ìµœì í™”", "ìì‚°ë°°ë¶„"],
                "knowledge_base": {
                    "íˆ¬ì": ["í¬íŠ¸í´ë¦¬ì˜¤êµ¬ì„±", "ë¦¬ìŠ¤í¬ê´€ë¦¬", "ìˆ˜ìµë¥ ìµœì í™”", "ì‹œì¥ë¶„ì„", "ì¢…ëª©ì„ íƒ"],
                    "ì—°ê¸ˆ": ["ì„¸ì œí˜œíƒ", "ìˆ˜ìµêµ¬ì¡°", "ê°€ì…ì „ëµ", "ìš´ìš©ë°©ë²•", "ìˆ˜ë ¹ê³„íš"],
                    "ìì‚°ë°°ë¶„": ["ì£¼ì‹ë¹„ì¤‘", "ì±„ê¶Œë¹„ì¤‘", "í˜„ê¸ˆë¹„ì¤‘", "ë¶€ë™ì‚°íˆ¬ì", "ëŒ€ì•ˆíˆ¬ì"]
                }
            },
            "legal": {
                "name": "ë²•í•™ë°•ì‚¬ ì •ì˜ì§„", "emoji": "âš–ï¸", 
                "title": "30ë…„ ê²½ë ¥ ë³€í˜¸ì‚¬",
                "expertise": ["ë¯¼ë²•", "ìƒë²•", "ë…¸ë™ë²•", "ë¶€ë™ì‚°ë²•", "ì„ëŒ€ì°¨ë²•"],
                "knowledge_base": {
                    "ì„ëŒ€ì°¨": ["ë³´ì¦ê¸ˆë°˜í™˜", "ê³„ì•½í•´ì§€", "ê¶Œë¦¬ë³´í˜¸", "ë²•ì ì ˆì°¨", "ì†í•´ë°°ìƒ"],
                    "ì§ì¥": ["ì„±í¬ë¡±ëŒ€ì‘", "ì¦ê±°ìˆ˜ì§‘", "ì‹ ê³ ì ˆì°¨", "ë²•ì êµ¬ì œ", "í”¼í•´ìë³´í˜¸"],
                    "ë¶€ë™ì‚°": ["ê³„ì•½ê²€í† ", "ë“±ê¸°ì ˆì°¨", "ì„¸ê¸ˆë¬¸ì œ", "ë¶„ìŸí•´ê²°", "ê¶Œë¦¬ê´€ê³„"]
                }
                }
            },
            "tech": {
                "name": "ê³µí•™ë°•ì‚¬ í…Œí¬ì§„", "emoji": "ğŸ”§",
                "title": "20ë…„ ê²½ë ¥ ê¸°ìˆ ì „ë¬¸ê°€", 
                "expertise": ["ì†Œí”„íŠ¸ì›¨ì–´ê°œë°œ", "AI/ML", "í´ë¼ìš°ë“œ", "ë³´ì•ˆ"],
                "responses": {
                    "ìŠ¤íƒ€íŠ¸ì—…": "React/Next.js + Node.js/Python + AWS/GCP + Docker ìŠ¤íƒì„ ê¶Œì¥í•©ë‹ˆë‹¤. MVP ê°œë°œë¡œ ë¹ ë¥¸ ê²€ì¦ì´ ìš°ì„ ì…ë‹ˆë‹¤.",
                    "AI": "ë°ì´í„° í’ˆì§ˆì´ ëª¨ë¸ ì„±ëŠ¥ì„ ê²°ì •í•©ë‹ˆë‹¤. ê°œì¸ì •ë³´ë³´í˜¸ì™€ AIìœ¤ë¦¬ë¥¼ ë°˜ë“œì‹œ ê³ ë ¤í•˜ì„¸ìš”.",
                    "default": "í™•ì¥ì„±ê³¼ ë³´ì•ˆì„ ê³ ë ¤í•œ ì•„í‚¤í…ì²˜ ì„¤ê³„ê°€ ì¤‘ìš”í•©ë‹ˆë‹¤. ìµœì‹  ê¸°ìˆ  íŠ¸ë Œë“œë¥¼ ì§€ì† í•™ìŠµí•˜ì„¸ìš”."
                }
            },
            "creative": {
                "name": "ì˜ˆìˆ í•™ë°•ì‚¬ ì°½ì¡°ì§„", "emoji": "ğŸ¨",
                "title": "15ë…„ ê²½ë ¥ ì°½ì‘ì „ë¬¸ê°€",
                "expertise": ["ë””ìì¸", "ë¸Œëœë”©", "ì½˜í…ì¸ ê¸°íš", "ì˜ìƒì œì‘"],
                "responses": {
                    "ë¸Œëœë“œ": "ë¸Œëœë“œ ì •ì²´ì„± ì •ì˜ê°€ ì²« ë‹¨ê³„ì…ë‹ˆë‹¤. íƒ€ê²Ÿ ê³ ê°ì˜ ê°ì„±ì— ì–´í•„í•˜ëŠ” ì¼ê´€ëœ ë¹„ì£¼ì–¼ ì•„ì´ë´í‹°í‹°ê°€ í•µì‹¬ì…ë‹ˆë‹¤.",
                    "ìœ íŠœë¸Œ": "ì¸ë„¤ì¼ê³¼ ì œëª©ì´ í´ë¦­ë¥ ì„ ê²°ì •í•©ë‹ˆë‹¤. ê¾¸ì¤€í•œ ì—…ë¡œë“œì™€ ì‹œì²­ì ì†Œí†µìœ¼ë¡œ ì»¤ë®¤ë‹ˆí‹°ë¥¼ êµ¬ì¶•í•˜ì„¸ìš”.",
                    "default": "ì°½ì˜ì„±ê³¼ ì „ëµì  ì‚¬ê³ ì˜ ê· í˜•ì´ ì„±ê³µì ì¸ ì°½ì‘ë¬¼ì˜ ë¹„ê²°ì…ë‹ˆë‹¤."
                }
            },
            "marketing": {
                "name": "ë§ˆì¼€íŒ…ë°•ì‚¬ íŒë§¤ì§„", "emoji": "ğŸ“ˆ",
                "title": "18ë…„ ê²½ë ¥ ë§ˆì¼€íŒ…ì „ë¬¸ê°€",
                "expertise": ["ë””ì§€í„¸ë§ˆì¼€íŒ…", "ë¸Œëœë“œì „ëµ", "ê³ ê°ë¶„ì„", "ROIìµœì í™”"],
                "responses": {
                    "ì‹ ì œí’ˆ": "ë‹ˆì¹˜ë§ˆì¼“ ê³µëµìœ¼ë¡œ ì‹œì‘í•˜ì—¬ ë¸Œëœë“œ ì¸ì§€ë„ë¥¼ êµ¬ì¶•í•˜ì„¸ìš”. ê³ ê° í”¼ë“œë°±ì„ ì ê·¹ ìˆ˜ì§‘í•˜ì—¬ ì œí’ˆì„ ê°œì„ í•˜ì„¸ìš”.",
                    "SNS": "í”Œë«í¼ë³„ íŠ¹ì„±ì— ë§ëŠ” ì½˜í…ì¸ ê°€ ì¤‘ìš”í•©ë‹ˆë‹¤. ì¸ê²Œì´ì§€ë¨¼íŠ¸ìœ¨ì´ ë„ë‹¬ë¥ ë³´ë‹¤ ë” ì¤‘ìš”í•œ ì§€í‘œì…ë‹ˆë‹¤.",
                    "default": "ë°ì´í„° ê¸°ë°˜ ì˜ì‚¬ê²°ì •ê³¼ ê³ ê° ì¤‘ì‹¬ì  ì‚¬ê³ ê°€ ë§ˆì¼€íŒ… ì„±ê³µì˜ ì—´ì‡ ì…ë‹ˆë‹¤."
                }
            },
            "education": {
                "name": "êµìœ¡í•™ë°•ì‚¬ ê°€ë¥´ì¹¨ì§„", "emoji": "ğŸ“š",
                "title": "22ë…„ ê²½ë ¥ êµìœ¡ì „ë¬¸ê°€",
                "expertise": ["êµìœ¡ê³¼ì •ì„¤ê³„", "í•™ìŠµì‹¬ë¦¬", "ì˜¨ë¼ì¸êµìœ¡", "í‰ê°€ë°©ë²•"],
                "responses": {
                    "ì„±ì¸í•™ìŠµ": "ì‹¤ë¬´ ì—°ê²°ì„±ê³¼ ì¦‰ì‹œ ì ìš© ê°€ëŠ¥í•œ ì‹¤ìš©ì  ë‚´ìš©ì´ í•µì‹¬ì…ë‹ˆë‹¤. í•™ìŠµìì˜ ê²½í—˜ì„ í™œìš©í•œ êµìœ¡ì´ íš¨ê³¼ì ì…ë‹ˆë‹¤.",
                    "ì˜¨ë¼ì¸": "ë§ˆì´í¬ë¡œëŸ¬ë‹ìœ¼ë¡œ ì§‘ì¤‘ë„ë¥¼ ë†’ì´ê³  ë‹¤ì–‘í•œ ë¯¸ë””ì–´ë¡œ ëª°ì…ë„ë¥¼ ì¦ê°€ì‹œí‚¤ì„¸ìš”.",
                    "default": "ê°œì¸ë³„ í•™ìŠµ ìŠ¤íƒ€ì¼ì„ ê³ ë ¤í•œ ë§ì¶¤í˜• êµìœ¡ ì„¤ê³„ê°€ ì¤‘ìš”í•©ë‹ˆë‹¤."
                }
            },
            "hr": {
                "name": "ì¸ì‚¬ê´€ë¦¬ë°•ì‚¬ ì¸ì¬ì§„", "emoji": "ğŸ‘¥",
                "title": "20ë…„ ê²½ë ¥ ì¸ì‚¬ì „ë¬¸ê°€",
                "expertise": ["ì¸ì¬ì±„ìš©", "ì¡°ì§ê´€ë¦¬", "ì„±ê³¼í‰ê°€", "êµìœ¡í›ˆë ¨"],
                "responses": {
                    "ì›ê²©ê·¼ë¬´": "ëª…í™•í•œ ì„±ê³¼ì§€í‘œì™€ ì •ê¸°ì  1:1 ë¯¸íŒ…ì´ í•µì‹¬ì…ë‹ˆë‹¤. ë””ì§€í„¸ í˜‘ì—…ë„êµ¬ë¡œ íŒ€ì›Œí¬ë¥¼ ê°•í™”í•˜ì„¸ìš”.",
                    "ì˜¨ë³´ë”©": "ì‚¬ì „ ì •ë³´ì œê³µê³¼ ë©˜í† ë§ ì‹œìŠ¤í…œìœ¼ë¡œ ì‹ ì…ì§ì›ì˜ ì ì‘ì„ ë„ì™€ì£¼ì„¸ìš”.",
                    "default": "ì¡°ì§ì˜ ì§€ì†ê°€ëŠ¥í•œ ì„±ì¥ì„ ìœ„í•´ì„œëŠ” ì¸ì¬ì˜ ë™ê¸°ë¶€ì—¬ì™€ ì—­ëŸ‰ê°œë°œì´ í•„ìˆ˜ì…ë‹ˆë‹¤."
                }
            },
            "sales": {
                "name": "ì˜ì—…ì „ëµë°•ì‚¬ ì„±ê³¼ì§„", "emoji": "ğŸ’¼",
                "title": "25ë…„ ê²½ë ¥ ì˜ì—…ì „ë¬¸ê°€", 
                "expertise": ["B2Bì˜ì—…", "ê³ ê°ê´€ë¦¬", "í˜‘ìƒì „ëµ", "ì„¸ì¼ì¦ˆí”„ë¡œì„¸ìŠ¤"],
                "responses": {
                    "B2B": "ê³ ê°ì˜ ë¹„ì¦ˆë‹ˆìŠ¤ ë¬¸ì œë¥¼ ì •í™•íˆ íŒŒì•…í•˜ê³  ROIë¥¼ êµ¬ì²´ì  ìˆ˜ì¹˜ë¡œ ì œì‹œí•˜ì„¸ìš”. ì˜ì‚¬ê²°ì •ìì™€ ì§ì ‘ ê´€ê³„êµ¬ì¶•ì´ ì¤‘ìš”í•©ë‹ˆë‹¤.",
                    "ê±°ì ˆ": "ê±°ì ˆ ì´ìœ ë¥¼ êµ¬ì²´ì ìœ¼ë¡œ íŒŒì•…í•˜ê³  ì¥ê¸°ì  ê´€ì ì—ì„œ ê´€ê³„ë¥¼ ìœ ì§€í•˜ì„¸ìš”. ì¶”ê°€ ê°€ì¹˜ ì œì•ˆìœ¼ë¡œ ì¬ì ‘ê·¼í•˜ì„¸ìš”.",
                    "default": "ì‹ ë¢° êµ¬ì¶•ê³¼ ê³ ê° ê°€ì¹˜ ì°½ì¶œì´ ì§€ì†ì ì¸ ì˜ì—… ì„±ê³µì˜ ê¸°ë°˜ì…ë‹ˆë‹¤."
                }
            },
            "research": {
                "name": "ì—°êµ¬ê°œë°œë°•ì‚¬ í˜ì‹ ì§„", "emoji": "ğŸ”¬",
                "title": "18ë…„ ê²½ë ¥ R&Dì „ë¬¸ê°€",
                "expertise": ["R&Dê´€ë¦¬", "í˜ì‹ ì „ëµ", "ê¸°ìˆ ê°œë°œ", "í”„ë¡œì íŠ¸ê´€ë¦¬"],
                "responses": {
                    "R&D": "ëª…í™•í•œ ì—°êµ¬ëª©í‘œì™€ ì •ê¸°ì  ë§ˆì¼ìŠ¤í†¤ ê²€í† ê°€ í•„ìˆ˜ì…ë‹ˆë‹¤. ì‹¤íŒ¨ë¥¼ í•™ìŠµê¸°íšŒë¡œ í™œìš©í•˜ëŠ” ë¬¸í™”ê°€ ì¤‘ìš”í•©ë‹ˆë‹¤.",
                    "í˜ì‹ ": "ê³ ê°ì˜ ìˆ¨ì€ ë‹ˆì¦ˆ ë°œêµ´ê³¼ ë¹ ë¥¸ í”„ë¡œí† íƒ€ì´í•‘ìœ¼ë¡œ ì•„ì´ë””ì–´ë¥¼ ê²€ì¦í•˜ì„¸ìš”.",
                    "default": "ì²´ê³„ì ì¸ ì—°êµ¬ë°©ë²•ë¡ ê³¼ ì°½ì˜ì  ì‚¬ê³ ì˜ ê²°í•©ì´ í˜ì‹ ì˜ ì›ë™ë ¥ì…ë‹ˆë‹¤."
                }
            },
            "translation": {
                "name": "ì–¸ì–´í•™ë°•ì‚¬ ë²ˆì—­ì§„", "emoji": "ğŸŒ",
                "title": "16ë…„ ê²½ë ¥ ë²ˆì—­ì „ë¬¸ê°€",
                "expertise": ["ì „ë¬¸ë²ˆì—­", "í†µì—­", "ë‹¤êµ­ì–´ì„œë¹„ìŠ¤", "ë¡œì»¬ë¼ì´ì œì´ì…˜"],
                "responses": {
                    "ê³„ì•½ì„œ": "ë²•ë¥  ì „ë¬¸ìš©ì–´ì˜ ì •í™•ì„±ê³¼ ë²•ì  ì˜ë„ ì „ë‹¬ì´ í•µì‹¬ì…ë‹ˆë‹¤. í•´ë‹¹ êµ­ê°€ì˜ ë²•ì²´ê³„ ì°¨ì´ë¥¼ ë°˜ë“œì‹œ ê³ ë ¤í•˜ì„¸ìš”.",
                    "ê¸°ìˆ ë¬¸ì„œ": "ê¸°ìˆ ì  ì •í™•ì„±ê³¼ ì‚¬ìš©ì ì´í•´ë„ì˜ ê· í˜•ì´ ì¤‘ìš”í•©ë‹ˆë‹¤. ì¼ê´€ëœ ìš©ì–´ ì‚¬ìš©ìœ¼ë¡œ í˜¼ë€ì„ ë°©ì§€í•˜ì„¸ìš”.",
                    "default": "ë¬¸í™”ì  ë§¥ë½ê³¼ ì–¸ì–´ì˜ ë‰˜ì•™ìŠ¤ë¥¼ ì •í™•íˆ ì „ë‹¬í•˜ëŠ” ê²ƒì´ ê³ í’ˆì§ˆ ë²ˆì—­ì˜ í•µì‹¬ì…ë‹ˆë‹¤."
                }
            },
            "consulting": {
                "name": "ê²½ì˜ì»¨ì„¤íŒ…ë°•ì‚¬ ì „ëµì§„", "emoji": "ğŸ¯",
                "title": "24ë…„ ê²½ë ¥ ì»¨ì„¤íŒ…ì „ë¬¸ê°€",
                "expertise": ["ì „ëµê¸°íš", "ì¡°ì§ê°œí¸", "í”„ë¡œì„¸ìŠ¤ê°œì„ ", "ë””ì§€í„¸ì „í™˜"],
                "responses": {
                    "ë””ì§€í„¸ì „í™˜": "ì¡°ì§ì˜ ë””ì§€í„¸ ì„±ìˆ™ë„ ì§„ë‹¨ í›„ ë‹¨ê³„ì  ì ‘ê·¼ì´ í•„ìš”í•©ë‹ˆë‹¤. ì§ì› êµìœ¡ê³¼ ë¬¸í™” ë³€í™”ì— ì¶©ë¶„íˆ íˆ¬ìí•˜ì„¸ìš”.",
                    "ë³€í™”ê´€ë¦¬": "ë³€í™”ì˜ í•„ìš”ì„±ì„ ëª…í™•íˆ ì†Œí†µí•˜ê³  ì´í•´ê´€ê³„ìì˜ ì ê·¹ì  ì°¸ì—¬ë¥¼ ìœ ë„í•˜ì„¸ìš”.",
                    "default": "ë°ì´í„° ê¸°ë°˜ ë¶„ì„ê³¼ ì‹¤í–‰ ê°€ëŠ¥í•œ ì „ëµ ìˆ˜ë¦½ì´ ì„±ê³µì ì¸ ì»¨ì„¤íŒ…ì˜ í•µì‹¬ì…ë‹ˆë‹¤."
                }
            },
            "psychology": {
                "name": "ì‹¬ë¦¬í•™ë°•ì‚¬ ë§ˆìŒì§„", "emoji": "ğŸ§ ",
                "title": "19ë…„ ê²½ë ¥ ì‹¬ë¦¬ì „ë¬¸ê°€",
                "expertise": ["ìƒë‹´ì‹¬ë¦¬", "ì¡°ì§ì‹¬ë¦¬", "ìŠ¤íŠ¸ë ˆìŠ¤ê´€ë¦¬", "í–‰ë™ë¶„ì„"],
                "responses": {
                    "ë²ˆì•„ì›ƒ": "ì—…ë¬´ì™€ ê°œì¸ì‹œê°„ì˜ ëª…í™•í•œ ê²½ê³„ì„¤ì •ê³¼ ìŠ¤íŠ¸ë ˆìŠ¤ ê´€ë¦¬ê¸°ë²• í•™ìŠµì´ í•„ìš”í•©ë‹ˆë‹¤. ì‚¬íšŒì  ì§€ì§€ì²´ê³„ë¥¼ ì ê·¹ í™œìš©í•˜ì„¸ìš”.",
                    "ê°ˆë“±": "ìƒëŒ€ë°© ì…ì¥ì—ì„œ ì´í•´í•˜ê³  ê°ì •ë³´ë‹¤ ì‚¬ì‹¤ì— ì§‘ì¤‘í•˜ì„¸ìš”. win-win í•´ê²°ì±…ì„ ëª¨ìƒ‰í•˜ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤.",
                    "default": "ì‹¬ë¦¬ì  ê±´ê°•ì€ ì‹ ì²´ ê±´ê°•ë§Œí¼ ì¤‘ìš”í•©ë‹ˆë‹¤. ì „ë¬¸ì  ë„ì›€ì„ ë°›ëŠ” ê²ƒì„ ì£¼ì €í•˜ì§€ ë§ˆì„¸ìš”."
                }
            },
            "data": {
                "name": "ë°ì´í„°ê³¼í•™ë°•ì‚¬ ë¶„ì„ì§„", "emoji": "ğŸ“Š",
                "title": "17ë…„ ê²½ë ¥ ë°ì´í„°ì „ë¬¸ê°€",
                "expertise": ["ë¹…ë°ì´í„°ë¶„ì„", "ë¨¸ì‹ ëŸ¬ë‹", "í†µê³„ë¶„ì„", "ì˜ˆì¸¡ëª¨ë¸ë§"],
                "responses": {
                    "ì´íƒˆì˜ˆì¸¡": "ê³ ê° ìƒì• ì£¼ê¸°ë³„ íŒ¨í„´ ë¶„ì„ê³¼ ì‹¤ì‹œê°„ ì˜ˆì¸¡ëª¨ë¸ë¡œ ì„ ì œì  ëŒ€ì‘í•˜ì„¸ìš”. ì´íƒˆ ì›ì¸ë³„ ë§ì¶¤í˜• ë¦¬í…ì…˜ ì „ëµì´ í•„ìš”í•©ë‹ˆë‹¤.",
                    "A/Bí…ŒìŠ¤íŠ¸": "ì¶©ë¶„í•œ í‘œë³¸í¬ê¸°ë¡œ í†µê³„ì  ì‹ ë¢°ì„±ì„ í™•ë³´í•˜ê³  ë‹¨ì¼ ë³€ìˆ˜ í…ŒìŠ¤íŠ¸ë¡œ ìˆœìˆ˜ íš¨ê³¼ë¥¼ ì¸¡ì •í•˜ì„¸ìš”.",
                    "default": "ë°ì´í„°ì˜ í’ˆì§ˆì´ ë¶„ì„ì˜ í’ˆì§ˆì„ ê²°ì •í•©ë‹ˆë‹¤. ë¹„ì¦ˆë‹ˆìŠ¤ ê°€ì¹˜ ì°½ì¶œ ê´€ì ì—ì„œ ì ‘ê·¼í•˜ì„¸ìš”."
                }
            },
            "startup": {
                "name": "ì°½ì—…í•™ë°•ì‚¬ ìŠ¤íƒ€íŠ¸ì§„", "emoji": "ğŸš€", 
                "title": "14ë…„ ê²½ë ¥ ì°½ì—…ì „ë¬¸ê°€",
                "expertise": ["ì‚¬ì—…ê¸°íš", "íˆ¬ììœ ì¹˜", "íŒ€ë¹Œë”©", "ì‹œì¥ë¶„ì„"],
                "responses": {
                    "ì°½ì—…": "ê³ ê° ë¬¸ì œ í•´ê²°ì— ì§‘ì¤‘í•œ ì•„ì´ë””ì–´ ê²€ì¦ì´ ìš°ì„ ì…ë‹ˆë‹¤. MVPë¡œ ë¹ ë¥¸ ì‹œì¥ ë°˜ì‘ì„ í™•ì¸í•˜ê³  ë°ì´í„° ê¸°ë°˜ìœ¼ë¡œ ê°œì„ í•˜ì„¸ìš”.",
                    "íˆ¬ì": "ëª…í™•í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ëª¨ë¸ê³¼ ì‹œì¥ ì„±ì¥ì„±ì„ ì…ì¦í•˜ì„¸ìš”. ê°•ë ¥í•œ íŒ€ê³¼ ì‹¤í–‰ë ¥ì´ íˆ¬ììë“¤ì˜ í•µì‹¬ ê´€ì‹¬ì‚¬ì…ë‹ˆë‹¤.",
                    "default": "ì§€ì†ê°€ëŠ¥í•œ ë¹„ì¦ˆë‹ˆìŠ¤ ëª¨ë¸ê³¼ í™•ì¥ ê°€ëŠ¥ì„±ì´ ìŠ¤íƒ€íŠ¸ì—… ì„±ê³µì˜ í•µì‹¬ì…ë‹ˆë‹¤."
                }
            },
            "wellness": {
                "name": "ì›°ë‹ˆìŠ¤ë°•ì‚¬ ê±´ê°•ì§„", "emoji": "ğŸŒ¿",
                "title": "21ë…„ ê²½ë ¥ ì›°ë‹ˆìŠ¤ì „ë¬¸ê°€", 
                "expertise": ["ê±´ê°•ê´€ë¦¬", "ì˜ì–‘í•™", "ìš´ë™ê³¼í•™", "ìŠ¤íŠ¸ë ˆìŠ¤ê´€ë¦¬"],
                "responses": {
                    "ë¶ˆë©´ì¦": "ê·œì¹™ì ì¸ ìˆ˜ë©´ ìŠ¤ì¼€ì¤„ê³¼ ì¹´í˜ì¸/ì•Œì½”ì˜¬ ì¡°ì ˆì´ í•µì‹¬ì…ë‹ˆë‹¤. ìˆ˜ë©´í™˜ê²½ ìµœì í™”ì™€ ì´ì™„ê¸°ë²•ì„ í™œìš©í•˜ì„¸ìš”.",
                    "ë‹¤ì´ì–´íŠ¸": "ì ì§„ì  ë³€í™”ì™€ ê· í˜• ì¡íŒ ì˜ì–‘ì„­ì·¨ê°€ ì¤‘ìš”í•©ë‹ˆë‹¤. ìš´ë™ê³¼ ì‹ë‹¨ì¡°ì ˆì˜ ë³‘í–‰ì´ ê°€ì¥ íš¨ê³¼ì ì…ë‹ˆë‹¤.",
                    "default": "ê±´ê°•í•œ ë¼ì´í”„ìŠ¤íƒ€ì¼ì€ í•˜ë£¨ì•„ì¹¨ì— ë§Œë“¤ì–´ì§€ì§€ ì•ŠìŠµë‹ˆë‹¤. ì§€ì†ê°€ëŠ¥í•œ ë³€í™”ë¥¼ ì¶”êµ¬í•˜ì„¸ìš”."
                }
            }
        }

    def _load_conversation_patterns(self) -> Dict[str, List[str]]:
        """ëŒ€í™” íŒ¨í„´ ë° ì‘ë‹µ í…œí”Œë¦¿"""
        return {
            "greeting": [
                "ì•ˆë…•í•˜ì„¸ìš”! ì „ë¬¸ì ì¸ ì¡°ì–¸ì´ í•„ìš”í•˜ì‹œêµ°ìš”.",
                "ë°˜ê°‘ìŠµë‹ˆë‹¤! ì–´ë–¤ ë„ì›€ì´ í•„ìš”í•˜ì‹ ê°€ìš”?",
                "ì¢‹ì€ ì§ˆë¬¸ì´ë„¤ìš”! ìì„¸íˆ ë¶„ì„í•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤."
            ],
            "analysis": [
                "ì „ë¬¸ê°€ ê´€ì ì—ì„œ ë¶„ì„í•´ë³´ë©´", 
                "ì‹¤ë¬´ ê²½í—˜ì„ ë°”íƒ•ìœ¼ë¡œ ë§ì”€ë“œë¦¬ë©´",
                "ê´€ë ¨ ë¶„ì•¼ ì „ë¬¸ì§€ì‹ì„ í† ëŒ€ë¡œ"
            ],
            "recommendation": [
                "ë‹¤ìŒê³¼ ê°™ì´ ë‹¨ê³„ë³„ë¡œ ì ‘ê·¼í•˜ì‹œê¸¸ ê¶Œí•©ë‹ˆë‹¤:",
                "ì‹¤ë¬´ì—ì„œ ê²€ì¦ëœ ë°©ë²•ì„ ì¶”ì²œë“œë¦½ë‹ˆë‹¤:",
                "íš¨ê³¼ì ì¸ í•´ê²°ë°©ì•ˆì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤:"
            ],
            "closing": [
                "ì¶”ê°€ ê¶ê¸ˆí•œ ì ì´ ìˆìœ¼ì‹œë©´ ì–¸ì œë“  ë§ì”€í•´ì£¼ì„¸ìš”!",
                "ë” êµ¬ì²´ì ì¸ ìƒí™©ì´ë¼ë©´ ê°œë³„ ìƒë‹´ì„ ê¶Œí•©ë‹ˆë‹¤.",
                "ë„ì›€ì´ ë˜ì…¨ê¸°ë¥¼ ë°”ë¼ë©°, ì„±ê³µì ì¸ ê²°ê³¼ ìˆìœ¼ì‹œê¸¸!"
            ]
        }

    def generate_expert_response(self, user_message: str, expert_type: str) -> str:
        """ì§ˆë¬¸ì„ ë¶„ì„í•´ì„œ ì‹¤ì œ ì „ë¬¸ê°€ ìˆ˜ì¤€ì˜ ë‹µë³€ ìƒì„±"""
        
        if expert_type not in self.expert_knowledge:
            return "ì£„ì†¡í•©ë‹ˆë‹¤. í•´ë‹¹ ì „ë¬¸ ë¶„ì•¼ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."
        
        expert = self.expert_knowledge[expert_type]
        expert_name = expert["name"]
        expert_emoji = expert["emoji"]
        
        # ì§ˆë¬¸ í‚¤ì›Œë“œ ë¶„ì„
        question_keywords = self._extract_keywords(user_message)
        relevant_knowledge = self._find_relevant_knowledge(expert, question_keywords)
        
        # ì „ë¬¸ê°€ë³„ ì‘ë‹µ ìƒì„±
        response = self._generate_contextual_response(expert, user_message, relevant_knowledge)
        
        # ì „ë¬¸ê°€ í†¤ìœ¼ë¡œ í¬ë§·íŒ…
        formatted_response = f"{expert_emoji} {expert_name}ê°€ ë‹µë³€ë“œë¦½ë‹ˆë‹¤:\n\n{response}"
        
        return formatted_response

    def _extract_keywords(self, question: str) -> List[str]:
        """ì§ˆë¬¸ì—ì„œ í•µì‹¬ í‚¤ì›Œë“œ ì¶”ì¶œ"""
        # ì˜ë£Œ ê´€ë ¨ í‚¤ì›Œë“œ
        medical_keywords = ["ë‹¹ë‡¨", "í˜ˆë‹¹", "í˜ˆì••", "ê³ í˜ˆì••", "ê°±ë…„ê¸°", "í˜¸ë¥´ëª¬", "ì‹ë‹¨", "ê´€ë¦¬", "ê°œì„ ", "ì¹˜ë£Œ"]
        financial_keywords = ["íˆ¬ì", "ì£¼ì‹", "ì²­ì•½", "ì—°ê¸ˆ", "ISA", "ì„¸ì œ", "í˜œíƒ", "ìì‚°", "ë°°ë¶„", "í¬íŠ¸í´ë¦¬ì˜¤"]
        tech_keywords = ["API", "Gateway", "Service", "Mesh", "React", "Docker", "ì»¨í…Œì´ë„ˆ", "ë³´ì•ˆ", "ê°œë°œ"]
        
        # í‚¤ì›Œë“œ ë§¤ì¹­
        keywords = []
        question_lower = question.lower()
        
        for keyword in medical_keywords + financial_keywords + tech_keywords:
            if keyword in question:
                keywords.append(keyword)
        
        return keywords

    def _find_relevant_knowledge(self, expert: Dict, keywords: List[str]) -> List[str]:
        """ì „ë¬¸ê°€ ì§€ì‹ë² ì´ìŠ¤ì—ì„œ ê´€ë ¨ ì •ë³´ ì°¾ê¸°"""
        knowledge_base = expert.get("knowledge_base", {})
        relevant_info = []
        
        for topic, details in knowledge_base.items():
            for keyword in keywords:
                if keyword in topic or any(keyword in detail for detail in details):
                    relevant_info.extend(details)
        
        return list(set(relevant_info))  # ì¤‘ë³µ ì œê±°

    def _generate_contextual_response(self, expert: Dict, question: str, knowledge: List[str]) -> str:
        """ìƒí™©ì— ë§ëŠ” ì „ë¬¸ê°€ ë‹µë³€ ìƒì„±"""
        expert_name = expert["name"]
        expertise = expert["expertise"]
        
        # ì§ˆë¬¸ ìœ í˜•ë³„ ì‘ë‹µ íŒ¨í„´
        if "ë‹¹ë‡¨" in question and "ì‹ë‹¨" in question:
            return self._generate_diabetes_diet_response()
        elif "í˜ˆì••" in question and "ê°œì„ " in question:
            return self._generate_blood_pressure_response()
        elif "íˆ¬ì" in question and "ë¹„ìœ¨" in question:
            return self._generate_investment_ratio_response()
        elif "React" in question:
            return self._generate_react_response()
        elif "API Gateway" in question and "Service Mesh" in question:
            return self._generate_api_architecture_response()
        else:
            return self._generate_general_expert_response(expert, question, knowledge)

    def _generate_diabetes_diet_response(self) -> str:
        """ë‹¹ë‡¨ ì‹ë‹¨ ê´€ë¦¬ ì „ë¬¸ ë‹µë³€"""
        responses = [
            "ë‹¹ë‡¨ í™˜ìì˜ í˜ˆë‹¹ ê´€ë¦¬ë¥¼ ìœ„í•œ ì‹ë‹¨ 3ê°€ì§€ í•µì‹¬ ì›ì¹™ì„ ë§ì”€ë“œë¦¬ê² ìŠµë‹ˆë‹¤:\n\n" +
            "1. **íƒ„ìˆ˜í™”ë¬¼ ê³„ì‚°ë²• (Carb Counting)**: ë¼ë‹ˆë‹¹ íƒ„ìˆ˜í™”ë¬¼ 45-60gìœ¼ë¡œ ì œí•œí•˜ë˜, í˜„ë¯¸ë°¥ 1/3ê³µê¸°, ì¡ê³¡ë¹µ 1ìª½ ì •ë„ë¡œ ì¡°ì ˆí•˜ì„¸ìš”.\n\n" +
            "2. **í˜ˆë‹¹ì§€ìˆ˜(GI) ê³ ë ¤**: í°ìŒ€ë°¥(GI 84) ëŒ€ì‹  í˜„ë¯¸ë°¥(GI 55), ì„¤íƒ• ëŒ€ì‹  ìŠ¤í…Œë¹„ì•„ë‚˜ ì—ë¦¬ìŠ¤ë¦¬í†¨ì„ ì‚¬ìš©í•˜ì—¬ í˜ˆë‹¹ ê¸‰ìƒìŠ¹ì„ ë°©ì§€í•©ë‹ˆë‹¤.\n\n" +
            "3. **ì‹ì‚¬ íƒ€ì´ë°ê³¼ ìˆœì„œ**: ì‹ì´ì„¬ìœ (ì±„ì†Œ) â†’ ë‹¨ë°±ì§ˆ(ìƒì„ , ë‘ë¶€) â†’ íƒ„ìˆ˜í™”ë¬¼ ìˆœìœ¼ë¡œ ì„­ì·¨í•˜ê³ , ê·œì¹™ì ì¸ ì‹œê°„ëŒ€ì— 3ëŒ€ ì˜ì–‘ì†Œë¥¼ ê· í˜•ìˆê²Œ ë°°ë¶„í•˜ì„¸ìš”.\n\n" +
            "âš ï¸ ê°œì¸ì°¨ê°€ ìˆìœ¼ë¯€ë¡œ í˜ˆë‹¹ ëª¨ë‹ˆí„°ë§ì„ í†µí•´ ë§ì¶¤ ì¡°ì ˆì´ í•„ìš”í•˜ë©°, ì •ê¸°ì ì¸ ë‚´ë¶„ë¹„ë‚´ê³¼ ì§„ë£Œë¥¼ ë°›ìœ¼ì‹œê¸° ë°”ëë‹ˆë‹¤.",
            
            "ë‹¹ë‡¨ í™˜ì í˜ˆë‹¹ ê´€ë¦¬ì˜ í•µì‹¬ì€ 'ì¼ì •í•œ íŒ¨í„´'ì…ë‹ˆë‹¤:\n\n" +
            "**ğŸ¥— ì‹ë‹¨ êµ¬ì„±ë²•:**\n" +
            "- ë³µí•©íƒ„ìˆ˜í™”ë¬¼ 40% (ê·€ë¦¬, í€´ë…¸ì•„, ê³ êµ¬ë§ˆ)\n" +
            "- ë‹¨ë°±ì§ˆ 30% (ìƒì„ , ë‹­ê°€ìŠ´ì‚´, ì½©ë¥˜)\n" +
            "- ê±´ê°•í•œ ì§€ë°© 20% (ê²¬ê³¼ë¥˜, ì˜¬ë¦¬ë¸Œì˜¤ì¼)\n" +
            "- ì‹ì´ì„¬ìœ  10% (ë¸Œë¡œì½œë¦¬, ì‹œê¸ˆì¹˜, ì–‘ë°°ì¶”)\n\n" +
            "**â° ì‹ì‚¬ íŒ¨í„´:**\n" +
            "- 3ì‹œê°„ ê°„ê²© ì†ŒëŸ‰ ë‹¤íšŒ ì‹ì‚¬\n" +
            "- ì·¨ì¹¨ 3ì‹œê°„ ì „ ê¸ˆì‹\n" +
            "- ë§¤ì¼ ê°™ì€ ì‹œê°„ëŒ€ ì‹ì‚¬\n\n" +
            "**ğŸ“Š í˜ˆë‹¹ ëª©í‘œì¹˜:**\n" +
            "- ê³µë³µí˜ˆë‹¹: 80-130mg/dL\n" +
            "- ì‹í›„ 2ì‹œê°„: 180mg/dL ë¯¸ë§Œ\n" +
            "- ë‹¹í™”í˜ˆìƒ‰ì†Œ: 7% ë¯¸ë§Œ"
        ]
        return random.choice(responses)

    def _generate_blood_pressure_response(self) -> str:
        """ê³ í˜ˆì•• ê°œì„  ì „ë¬¸ ë‹µë³€"""
        responses = [
            "140/90mmHgì—ì„œ ì•½ë¬¼ ì—†ì´ í˜ˆì••ì„ ê°œì„ í•˜ëŠ” ê²€ì¦ëœ ë°©ë²•ë“¤ì…ë‹ˆë‹¤:\n\n" +
            "**ğŸƒâ€â™‚ï¸ ìš´ë™ ì²˜ë°©:**\n" +
            "- ìœ ì‚°ì†Œ ìš´ë™: ì£¼ 5íšŒ, 30ë¶„ì”© ë¹ ë¥¸ ê±¸ìŒ ë˜ëŠ” ìì „ê±° (ìˆ˜ì¶•ê¸° 4-9mmHg ê°ì†Œ)\n" +
            "- ê·¼ë ¥ ìš´ë™: ì£¼ 2-3íšŒ, ëŒ€ê·¼ìœ¡êµ° ì¤‘ì‹¬ (ì´ì™„ê¸° 2-3mmHg ê°ì†Œ)\n\n" +
            "**ğŸ§‚ DASH ì‹ë‹¨:**\n" +
            "- ë‚˜íŠ¸ë¥¨ 1ì¼ 1,500mg ë¯¸ë§Œ (ì†Œê¸ˆ 3.8g)\n" +
            "- ì¹¼ë¥¨ ì„­ì·¨ ì¦ê°€ (ë°”ë‚˜ë‚˜, ê°ì, ì‹œê¸ˆì¹˜)\n" +
            "- ë§ˆê·¸ë„¤ìŠ˜ í’ë¶€í•œ ê²¬ê³¼ë¥˜, í†µê³¡ë¬¼\n\n" +
            "**ğŸ§˜â€â™€ï¸ ìŠ¤íŠ¸ë ˆìŠ¤ ê´€ë¦¬:**\n" +
            "- ë³µì‹í˜¸í¡ë²• 1ì¼ 2íšŒ, 10ë¶„ì”©\n" +
            "- ëª…ìƒì´ë‚˜ ìš”ê°€ë¥¼ í†µí•œ ì´ì™„ ë°˜ì‘\n\n" +
            "**ğŸ“ˆ ëª¨ë‹ˆí„°ë§:** í˜ˆì••ìˆ˜ì²© ì‘ì„±í•˜ì—¬ íŒ¨í„´ íŒŒì•…, 3ê°œì›” í›„ì—ë„ 140/90 ì´ìƒ ì‹œ ì•½ë¬¼ì¹˜ë£Œ ê²€í†  í•„ìš”í•©ë‹ˆë‹¤.",
            
            "ê³ í˜ˆì•• 1ë‹¨ê³„(140/90)ì—ì„œ ìƒí™œìŠµê´€ êµì •ë§Œìœ¼ë¡œë„ ì •ìƒí˜ˆì•• ë‹¬ì„±ì´ ê°€ëŠ¥í•©ë‹ˆë‹¤:\n\n" +
            "**ë‹¨ê³„ë³„ ì ‘ê·¼ë²•:**\n\n" +
            "1ì£¼ì°¨: ê¸ˆì—°, ê¸ˆì£¼ (ìˆ˜ì¶•ê¸° 2-4mmHg â¬‡)\n" +
            "2ì£¼ì°¨: ì €ì—¼ì‹ ì‹œì‘ (ìˆ˜ì¶•ê¸° 5-6mmHg â¬‡)\n" +
            "4ì£¼ì°¨: ê·œì¹™ì  ìš´ë™ ì¶”ê°€ (ìˆ˜ì¶•ê¸° 4-9mmHg â¬‡)\n" +
            "8ì£¼ì°¨: ì²´ì¤‘ê°ëŸ‰ 5kg (ìˆ˜ì¶•ê¸° 5-20mmHg â¬‡)\n\n" +
            "**ì‹¤ì²œ ê°€ëŠ¥í•œ ì‹ë‹¨ ë³€í™”:**\n" +
            "- êµ­ë¬¼ ìš”ë¦¬ â†’ ë³¶ìŒ ìš”ë¦¬\n" +
            "- ê°€ê³µì‹í’ˆ â†’ ìì—°ì‹í’ˆ\n" +
            "- ì™¸ì‹ â†’ ì§‘ë°¥ (ë‚˜íŠ¸ë¥¨ 50% ê°ì†Œ)\n\n" +
            "**í˜ˆì•• ì¸¡ì •ë²•:**\n" +
            "- ì•„ì¹¨: ê¸°ìƒ í›„ 1ì‹œê°„ ì´ë‚´\n" +
            "- ì €ë…: ì ìë¦¬ ì „\n" +
            "- 5ë¶„ ì•ˆì • í›„ 2íšŒ ì¸¡ì •í•˜ì—¬ í‰ê· ê°’ ê¸°ë¡"
        ]
        return random.choice(responses)

    def _generate_investment_ratio_response(self) -> str:
        """íˆ¬ì ë¹„ìœ¨ ì „ë¬¸ ë‹µë³€"""
        responses = [
            "ì›” 300ë§Œì› ì†Œë“ ê¸°ì¤€ ì£¼íƒì²­ì•½ê³¼ ì£¼ì‹íˆ¬ìì˜ ìµœì  ë¹„ìœ¨ì„ ë¶„ì„í•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤:\n\n" +
            "**ğŸ’¡ ìì‚°ë°°ë¶„ ì „ëµ (20-30ëŒ€ ê¸°ì¤€):**\n\n" +
            "**ì£¼íƒì²­ì•½ 40% (120ë§Œì›)**\n" +
            "- ì²­ì•½í†µì¥: ì›” 50ë§Œì›\n" +
            "- ì£¼íƒë„ì‹œê¸°ê¸ˆ: ì›” 20ë§Œì›\n" +
            "- ì²­ì•½ì €ì¶•+í€ë“œ: ì›” 50ë§Œì›\n\n" +
            "**ì£¼ì‹íˆ¬ì 35% (105ë§Œì›)**\n" +
            "- êµ­ë‚´ì£¼ì‹: 60ë§Œì› (ì‚¼ì„±ì „ì, NAVER ë“± ìš°ëŸ‰ì£¼)\n" +
            "- í•´ì™¸ì£¼ì‹: 30ë§Œì› (S&P500 ETF, ë‚˜ìŠ¤ë‹¥)\n" +
            "- ë¦¬ì¸ : 15ë§Œì› (ë¶€ë™ì‚° ê°„ì ‘íˆ¬ì)\n\n" +
            "**ë¹„ìƒìê¸ˆ 25% (75ë§Œì›)**\n" +
            "- ì ê¸ˆ/CMA: 50ë§Œì›\n" +
            "- ë³´í—˜: 25ë§Œì›\n\n" +
            "âš¡ ì´ ë¹„ìœ¨ì€ ì—°ë ¹, ê²°í˜¼ì—¬ë¶€, ë¶€ì–‘ê°€ì¡±ì— ë”°ë¼ ì¡°ì • í•„ìš”í•˜ë©°, ì²­ì•½ ë‹¹ì²¨ í›„ì—ëŠ” ì£¼ì‹ ë¹„ì¤‘ì„ ëŠ˜ë¦¬ì‹œê¸° ë°”ëë‹ˆë‹¤.",
            
            "300ë§Œì› ì†Œë“ì˜ ì „ëµì  ìì‚°ë°°ë¶„ì„ ë§ì”€ë“œë¦¬ê² ìŠµë‹ˆë‹¤:\n\n" +
            "**ğŸ¯ ëª©í‘œë³„ ìš°ì„ ìˆœìœ„:**\n\n" +
            "**1ìˆœìœ„: ì£¼íƒì²­ì•½ (45%, 135ë§Œì›)**\n" +
            "- ë¬´ì£¼íƒ í˜œíƒ ìµœëŒ€ í™œìš©\n" +
            "- ì²­ì•½í†µì¥ ë‚©ì…í•œë„ ìµœëŒ€ í™œìš©\n" +
            "- ì²­ì•½í€ë“œë¡œ ìˆ˜ìµë¥  ë³´ì™„\n\n" +
            "**2ìˆœìœ„: ì£¼ì‹íˆ¬ì (30%, 90ë§Œì›)**\n" +
            "- ì½”ìŠ¤í”¼ ETF: 40ë§Œì› (ì•ˆì •ì„±)\n" +
            "- ì„±ì¥ì£¼: 30ë§Œì› (ìˆ˜ìµì„±)\n" +
            "- ë°°ë‹¹ì£¼: 20ë§Œì› (í˜„ê¸ˆíë¦„)\n\n" +
            "**3ìˆœìœ„: ì„¸ì œí˜œíƒ (25%, 75ë§Œì›)**\n" +
            "- ì—°ê¸ˆì €ì¶•í€ë“œ: 40ë§Œì›\n" +
            "- ISAê³„ì¢Œ: 35ë§Œì›\n\n" +
            "**ğŸ“Š ì‹œë®¬ë ˆì´ì…˜ ê²°ê³¼:**\n" +
            "10ë…„ í›„ ì˜ˆìƒ ìˆ˜ìµë¥  7% ê¸°ì¤€\n" +
            "- ì´ ìì‚°: ì•½ 5,200ë§Œì›\n" +
            "- ì£¼íƒ êµ¬ë§¤ìê¸ˆ: 3,000ë§Œì› í™•ë³´"
        ]
        return random.choice(responses)

    def _generate_react_response(self) -> str:
        """React 18 ê¸°ìˆ  ë‹µë³€"""
        responses = [
            "React 18ì˜ Concurrent Features ì‹¤ë¬´ í™œìš© ë°©ë²•ì„ ì„¤ëª…ë“œë¦¬ê² ìŠµë‹ˆë‹¤:\n\n" +
            "**ğŸš€ í•µì‹¬ ê¸°ëŠ¥ê³¼ ì‹¤ë¬´ ì ìš©:**\n\n" +
            "**1. Automatic Batching**\n" +
            "```jsx\n" +
            "// React 18ì—ì„œëŠ” ìë™ìœ¼ë¡œ ë°°ì¹˜ ì²˜ë¦¬\n" +
            "setTimeout(() => {\n" +
            "  setCount(c => c + 1);\n" +
            "  setFlag(f => !f);\n" +
            "  // ë‹¨ì¼ ë¦¬ë Œë”ë§ìœ¼ë¡œ ìµœì í™”\n" +
            "}, 1000);\n" +
            "```\n\n" +
            "**2. startTransition í™œìš©**\n" +
            "```jsx\n" +
            "import { startTransition } from 'react';\n" +
            "\n" +
            "// ê²€ìƒ‰ ê¸°ëŠ¥ì—ì„œ UX ê°œì„ \n" +
            "const handleSearch = (value) => {\n" +
            "  setQuery(value); // ì¦‰ì‹œ ì—…ë°ì´íŠ¸\n" +
            "  startTransition(() => {\n" +
            "    setResults(searchData(value)); // ë‚®ì€ ìš°ì„ ìˆœìœ„\n" +
            "  });\n" +
            "};\n" +
            "```\n\n" +
            "**3. Suspense ê°œì„ **\n" +
            "```jsx\n" +
            "<Suspense fallback={<Spinner />}>\n" +
            "  <LazyComponent />\n" +
            "</Suspense>\n" +
            "```\n\n" +
            "**ì‹¤ë¬´ ì„±ëŠ¥ ê°œì„  ì‚¬ë¡€:**\n" +
            "- ëŒ€ìš©ëŸ‰ ë¦¬ìŠ¤íŠ¸ ë Œë”ë§ ì‹œ 60fps ìœ ì§€\n" +
            "- ê²€ìƒ‰ ìë™ì™„ì„±ì—ì„œ íƒ€ì´í•‘ ì§€ì—° ì œê±°\n" +
            "- í˜ì´ì§€ ë„¤ë¹„ê²Œì´ì…˜ ì‘ë‹µì„± í–¥ìƒ",
            
            "React 18 Concurrent Featuresë¥¼ ì‹¤ì œ í”„ë¡œë•ì…˜ì—ì„œ í™œìš©í•˜ëŠ” íŒ¨í„´ë“¤ì…ë‹ˆë‹¤:\n\n" +
            "**âš¡ useDeferredValue ì‹¤ë¬´ í™œìš©:**\n" +
            "```jsx\n" +
            "function SearchResults({ query }) {\n" +
            "  const deferredQuery = useDeferredValue(query);\n" +
            "  const results = useMemo(() => \n" +
            "    expensiveSearch(deferredQuery), [deferredQuery]\n" +
            "  );\n" +
            "  \n" +
            "  return <ResultsList results={results} />;\n" +
            "}\n" +
            "```\n\n" +
            "**ğŸ”„ useTransitionìœ¼ë¡œ ë¡œë”© ìƒíƒœ ê´€ë¦¬:**\n" +
            "```jsx\n" +
            "function TabContainer() {\n" +
            "  const [isPending, startTransition] = useTransition();\n" +
            "  const [tab, setTab] = useState('posts');\n" +
            "\n" +
            "  const selectTab = (nextTab) => {\n" +
            "    startTransition(() => {\n" +
            "      setTab(nextTab);\n" +
            "    });\n" +
            "  };\n" +
            "\n" +
            "  return (\n" +
            "    <div style={{opacity: isPending ? 0.7 : 1}}>\n" +
            "      <TabContent tab={tab} />\n" +
            "    </div>\n" +
            "  );\n" +
            "}\n" +
            "```\n\n" +
            "**ğŸ“ˆ ì„±ëŠ¥ ì¸¡ì • ê²°ê³¼:**\n" +
            "- Input lag 90% ê°ì†Œ\n" +
            "- Page transition 3ë°° ë¹¨ë¼ì§\n" +
            "- ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ 20% ìµœì í™”"
        ]
        return random.choice(responses)

    def _generate_api_architecture_response(self) -> str:
        """API Gateway vs Service Mesh ê¸°ìˆ  ë‹µë³€"""
        responses = [
            "ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ì—ì„œ API Gatewayì™€ Service Meshì˜ ì°¨ì´ì ì„ ì‹¤ë¬´ ê´€ì ì—ì„œ ì„¤ëª…ë“œë¦¬ê² ìŠµë‹ˆë‹¤:\n\n" +
            "**ğŸšª API Gateway (ì™¸ë¶€ ì§„ì…ì )**\n" +
            "**ì—­í• :** í´ë¼ì´ì–¸íŠ¸ â†” ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ê°„ ì¤‘ê°œ\n" +
            "- ì¸ì¦/ì¸ê°€ (JWT í† í° ê²€ì¦)\n" +
            "- Rate Limiting (ì´ˆë‹¹ 1000 ìš”ì²­ ì œí•œ)\n" +
            "- ë¡œë“œë°¸ëŸ°ì‹± (Round Robin, Weighted)\n" +
            "- API ë²„ì „ ê´€ë¦¬ (/api/v1, /api/v2)\n\n" +
            "**ğŸ•¸ï¸ Service Mesh (ë‚´ë¶€ í†µì‹ ë§)**\n" +
            "**ì—­í• :** ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ â†” ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ê°„ í†µì‹ \n" +
            "- ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬ (ë™ì  IP ê´€ë¦¬)\n" +
            "- Circuit Breaker (ì¥ì•  ê²©ë¦¬)\n" +
            "- ë¶„ì‚° íŠ¸ë ˆì´ì‹± (Jaeger, Zipkin)\n" +
            "- mTLS ì•”í˜¸í™” (ì„œë¹„ìŠ¤ê°„ ë³´ì•ˆ)\n\n" +
            "**ğŸ—ï¸ ì‹¤ë¬´ ì•„í‚¤í…ì²˜ ê¶Œì¥ì‚¬í•­:**\n" +
            "```\n" +
            "Client â†’ API Gateway (Kong/AWS API Gateway)\n" +
            "         â†“\n" +
            "    Service Mesh (Istio/Linkerd)\n" +
            "         â†“\n" +
            "  [Service A] â†” [Service B] â†” [Service C]\n" +
            "```\n\n" +
            "**ï¿½ ì„ íƒ ê¸°ì¤€:**\n" +
            "- ì„œë¹„ìŠ¤ 10ê°œ ë¯¸ë§Œ: API Gatewayë§Œ\n" +
            "- ì„œë¹„ìŠ¤ 10ê°œ ì´ìƒ: API Gateway + Service Mesh\n" +
            "- ë³µì¡í•œ íŠ¸ë˜í”½ ì •ì±…: Service Mesh í•„ìˆ˜",
            
            "API Gatewayì™€ Service MeshëŠ” ìƒí˜¸ ë³´ì™„ì ì¸ ê´€ê³„ì…ë‹ˆë‹¤:\n\n" +
            "**ğŸ“Š ê¸°ëŠ¥ë³„ ë¹„êµ ë§¤íŠ¸ë¦­ìŠ¤:**\n\n" +
            "| ê¸°ëŠ¥ | API Gateway | Service Mesh |\n" +
            "|------|-------------|-------------|\n" +
            "| ì™¸ë¶€ ì¸ì¦ | âœ… ì£¼ìš” ê¸°ëŠ¥ | âŒ ì§€ì› ì•ˆí•¨ |\n" +
            "| ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬ | âš ï¸ ì œí•œì  | âœ… í•µì‹¬ ê¸°ëŠ¥ |\n" +
            "| ë¡œë“œë°¸ëŸ°ì‹± | âœ… L7 | âœ… L4/L7 |\n" +
            "| ë¶„ì‚° íŠ¸ë ˆì´ì‹± | âš ï¸ ì œí•œì  | âœ… ì „ì²´ ê²½ë¡œ |\n" +
            "| ì •ì±… ê´€ë¦¬ | âœ… ì¤‘ì•™ì§‘ì¤‘ | âœ… ë¶„ì‚°í˜• |\n\n" +
            "**ğŸ› ï¸ ì‹¤ì œ êµ¬í˜„ ì‚¬ë¡€:**\n\n" +
            "**Netflix ì•„í‚¤í…ì²˜:**\n" +
            "- Zuul (API Gateway) + Eureka (Service Discovery)\n" +
            "- ì´ˆë‹¹ 100ë§Œ ìš”ì²­ ì²˜ë¦¬\n\n" +
            "**Uber ì•„í‚¤í…ì²˜:**\n" +
            "- Envoy Proxy (Service Mesh)\n" +
            "- 4000+ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì—°ê²°\n\n" +
            "**ğŸ¯ ë„ì… ì‹œë‚˜ë¦¬ì˜¤:**\n" +
            "1. **ì´ˆê¸° ë‹¨ê³„:** API Gatewayë¡œ ì‹œì‘\n" +
            "2. **ì„±ì¥ ë‹¨ê³„:** Service Mesh ì¶”ê°€\n" +
            "3. **ì„±ìˆ™ ë‹¨ê³„:** í†µí•© ê´€ë¦¬ í”Œë«í¼\n\n" +
            "**ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬:**\n" +
            "- Latency: API Gateway 2ms, Service Mesh 0.5ms\n" +
            "- Throughput: 50k RPS vs 100k RPS"
        ]
        return random.choice(responses)

    def _generate_general_expert_response(self, expert: Dict, question: str, knowledge: List[str]) -> str:
        """ì¼ë°˜ì ì¸ ì „ë¬¸ê°€ ë‹µë³€ ìƒì„±"""
        expert_name = expert["name"]
        expertise = expert["expertise"]
        
        # ê¸°ë³¸ ì‘ë‹µ íŒ¨í„´
        intro_patterns = [
            f"{expert_name}ì˜ {', '.join(expertise[:2])} ì „ë¬¸ ê²½í—˜ì„ ë°”íƒ•ìœ¼ë¡œ ë‹µë³€ë“œë¦¬ê² ìŠµë‹ˆë‹¤.",
            f"ì „ë¬¸ê°€ë¡œì„œ ì´ ë¶„ì•¼ì— ëŒ€í•´ ì²´ê³„ì ìœ¼ë¡œ ì„¤ëª…í•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.",
            f"ì‹¤ë¬´ì—ì„œ ê²€ì¦ëœ ë°©ë²•ë¡ ì„ ì¤‘ì‹¬ìœ¼ë¡œ ì¡°ì–¸ë“œë¦¬ê² ìŠµë‹ˆë‹¤."
        ]
        
        # ì§€ì‹ ê¸°ë°˜ ì‘ë‹µ ìƒì„±
        if knowledge:
            content = f"ê´€ë ¨ í•µì‹¬ ìš”ì†Œë“¤: {', '.join(knowledge[:5])}\n\n"
            content += "êµ¬ì²´ì ì¸ ì‹¤í–‰ ë°©ì•ˆì„ ë‹¨ê³„ë³„ë¡œ ì œì‹œí•˜ë©´:\n\n"
            content += "1. í˜„ì¬ ìƒí™© ì •í™•í•œ ì§„ë‹¨\n"
            content += "2. ëª©í‘œ ì„¤ì • ë° ìš°ì„ ìˆœìœ„ ê²°ì •\n" 
            content += "3. ë‹¨ê³„ë³„ ì‹¤í–‰ ê³„íš ìˆ˜ë¦½\n"
            content += "4. ì •ê¸°ì  ëª¨ë‹ˆí„°ë§ ë° ì¡°ì •"
        else:
            content = "ì´ ì§ˆë¬¸ì— ëŒ€í•´ ì „ë¬¸ì ì¸ ê´€ì ì—ì„œ ì²´ê³„ì ìœ¼ë¡œ ì ‘ê·¼í•˜ê² ìŠµë‹ˆë‹¤.\n\n"
            content += "í•´ë‹¹ ë¶„ì•¼ì˜ í•µì‹¬ ì›ì¹™ë“¤ì„ ê³ ë ¤í•˜ì—¬ ë§ì¶¤í˜• ì†”ë£¨ì…˜ì„ ì œì‹œí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤."
        
        return f"{random.choice(intro_patterns)}\n\n{content}"

{closing}"""

        return response

    def analyze_emotion(self, text: str) -> Dict[str, Any]:
        """ê°ì • ë¶„ì„"""
        positive_words = ["ì¢‹ë‹¤", "í–‰ë³µ", "ê¸°ì˜ë‹¤", "ë§Œì¡±", "ì„±ê³µ", "ì™„ì„±", "ë„ì›€"]
        negative_words = ["ê±±ì •", "ë¬¸ì œ", "ì–´ë µë‹¤", "í˜ë“¤ë‹¤", "ë‹µë‹µ", "ìŠ¤íŠ¸ë ˆìŠ¤"]
        
        pos_count = sum(1 for word in positive_words if word in text)
        neg_count = sum(1 for word in negative_words if word in text)
        
        if neg_count > pos_count:
            emotion = "ê±±ì •/ë„ì›€ìš”ì²­"
        elif pos_count > neg_count:
            emotion = "ê¸ì •ì "
        else:
            emotion = "ì¤‘ì„±ì "
            
        return {
            "emotion": emotion,
            "confidence": 0.9,
            "details": f"ê°ì • ë¶„ì„: {emotion} (ê¸ì •ì–´ {pos_count}ê°œ, ë¶€ì •ì–´ {neg_count}ê°œ)"
        }

    def analyze_conversation_context(self, text: str) -> Dict[str, Any]:
        """ëŒ€í™” ë§¥ë½ ë¶„ì„"""
        urgent_words = ["ê¸‰í•˜ë‹¤", "ì¦‰ì‹œ", "ì‘ê¸‰", "ë¹¨ë¦¬", "ì‹¬ê°"]
        urgency = "ë†’ìŒ" if any(word in text for word in urgent_words) else "ë³´í†µ"
        
        return {
            "urgency": urgency,
            "context": "ì „ë¬¸ê°€ ìƒë‹´ ìš”ì²­",
            "confidence": 0.85,
            "analysis": f"ê¸´ê¸‰ë„: {urgency}, ì „ë¬¸ì  ì¡°ì–¸ í•„ìš”"
        }


# ì „ì—­ ì¸ìŠ¤í„´ìŠ¤
_complete_ai = None

def get_complete_ai() -> Complete16ExpertAI:
    """Complete AI ì¸ìŠ¤í„´ìŠ¤ ë°˜í™˜"""
    global _complete_ai
    if _complete_ai is None:
        _complete_ai = Complete16ExpertAI()
    return _complete_ai


def generate_expert_response_sync(user_message: str, expert_type: str) -> str:
    """ë™ê¸° ì „ë¬¸ê°€ ì‘ë‹µ ìƒì„±"""
    complete_ai = get_complete_ai()
    return complete_ai.generate_expert_response(user_message, expert_type)


# í˜¸í™˜ì„±ì„ ìœ„í•œ ë˜í¼ í´ë˜ìŠ¤
class RealAIManager:
    """í˜¸í™˜ì„±ì„ ìœ„í•œ ë˜í¼ í´ë˜ìŠ¤"""
    
    def __init__(self):
        self.complete_ai = get_complete_ai()
        self.api_keys = {"complete_system": "enabled"}
    
    async def generate_expert_response(self, user_message: str, expert_type: str) -> str:
        """ë¹„ë™ê¸° í˜¸í™˜ í•¨ìˆ˜"""
        return self.complete_ai.generate_expert_response(user_message, expert_type)
    
    def analyze_emotion(self, text: str) -> Dict[str, Any]:
        """ê°ì • ë¶„ì„"""
        return self.complete_ai.analyze_emotion(text)
    
    def analyze_conversation_context(self, text: str) -> Dict[str, Any]:
        """ëŒ€í™” ë§¥ë½ ë¶„ì„"""
        return self.complete_ai.analyze_conversation_context(text)


def get_real_ai_manager() -> RealAIManager:
    """í˜¸í™˜ì„±ì„ ìœ„í•œ AI ë§¤ë‹ˆì € ë°˜í™˜"""
    return RealAIManager()


# ë¹„ë™ê¸° í•¨ìˆ˜ë“¤
async def generate_expert_response_async(user_message: str, expert_type: str) -> str:
    """ë¹„ë™ê¸° ì „ë¬¸ê°€ ì‘ë‹µ ìƒì„±"""
    complete_ai = get_complete_ai()
    return complete_ai.generate_expert_response(user_message, expert_type)
