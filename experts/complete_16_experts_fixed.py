"""
ì™„ì „í•œ 16ëª… ë°•ì‚¬ê¸‰ ì „ë¬¸ê°€ AI ì‹œìŠ¤í…œ - ì‹¤ì œ êµ¬ì²´ì  ë‹µë³€ ìƒì„±
"""

import re
import random
import json
from typing import Dict, Any, List
from datetime import datetime


class Complete16ExpertAI:
    """ì‹¤ì œ êµ¬ì²´ì  ë‹µë³€ì„ ìƒì„±í•˜ëŠ” 16ëª… ì „ë¬¸ê°€ AI ì‹œìŠ¤í…œ"""

    def __init__(self):
        self.expert_knowledge = self._load_all_16_experts()

    def _load_all_16_experts(self) -> Dict[str, Dict]:
        """16ëª… ì „ë¬¸ê°€ ì™„ì „ ë°ì´í„°ë² ì´ìŠ¤"""
        return {
            "medical": {
                "name": "ì˜í•™ë°•ì‚¬ í•˜ì´ì§„",
                "emoji": "ğŸ¥",
                "title": "20ë…„ ê²½ë ¥ ì„ìƒì˜ì‚¬",
            },
            "financial": {
                "name": "ê²½ì œí•™ë°•ì‚¬ ë¶€ìì§„",
                "emoji": "ğŸ’°",
                "title": "25ë…„ ê²½ë ¥ íˆ¬ìì „ë¬¸ê°€",
            },
            "legal": {
                "name": "ë²•í•™ë°•ì‚¬ ì •ì˜ì§„",
                "emoji": "âš–ï¸",
                "title": "30ë…„ ê²½ë ¥ ë³€í˜¸ì‚¬",
            },
            "tech": {
                "name": "ê³µí•™ë°•ì‚¬ í…Œí¬ì§„",
                "emoji": "ğŸ”§",
                "title": "15ë…„ ê²½ë ¥ ê¸°ìˆ ì „ë¬¸ê°€",
            },
            "creative": {
                "name": "ì˜ˆìˆ í•™ë°•ì‚¬ ì°½ì‘ì§„",
                "emoji": "ğŸ¨",
                "title": "18ë…„ ê²½ë ¥ ì°½ì‘ì „ë¬¸ê°€",
            },
            "marketing": {
                "name": "ë§ˆì¼€íŒ…ë°•ì‚¬ ë§ˆì§„",
                "emoji": "ğŸ“ˆ",
                "title": "16ë…„ ê²½ë ¥ ë§ˆì¼€íŒ…ì „ë¬¸ê°€",
            },
            "education": {
                "name": "êµìœ¡í•™ë°•ì‚¬ ê°€ë¥´ì§„",
                "emoji": "ğŸ“",
                "title": "22ë…„ ê²½ë ¥ êµìœ¡ì „ë¬¸ê°€",
            },
            "hr": {
                "name": "ì¸ì‚¬ê´€ë¦¬ë°•ì‚¬ ì¸ì¬ì§„",
                "emoji": "ğŸ‘¥",
                "title": "19ë…„ ê²½ë ¥ ì¸ì‚¬ì „ë¬¸ê°€",
            },
            "sales": {
                "name": "ê²½ì˜í•™ë°•ì‚¬ ì„¸ì¼ì§„",
                "emoji": "ğŸ’¼",
                "title": "23ë…„ ê²½ë ¥ ì˜ì—…ì „ë¬¸ê°€",
            },
            "research": {
                "name": "ì—°êµ¬ë°•ì‚¬ íƒêµ¬ì§„",
                "emoji": "ğŸ”¬",
                "title": "26ë…„ ê²½ë ¥ ì—°êµ¬ì „ë¬¸ê°€",
            },
            "translation": {
                "name": "ì–¸ì–´í•™ë°•ì‚¬ ë²ˆì—­ì§„",
                "emoji": "ğŸŒ",
                "title": "21ë…„ ê²½ë ¥ ë²ˆì—­ì „ë¬¸ê°€",
            },
            "consulting": {
                "name": "ì»¨ì„¤íŒ…ë°•ì‚¬ ì¡°ì–¸ì§„",
                "emoji": "ğŸ’¡",
                "title": "24ë…„ ê²½ë ¥ ì»¨ì„¤íŒ…ì „ë¬¸ê°€",
            },
            "psychology": {
                "name": "ì‹¬ë¦¬í•™ë°•ì‚¬ ë§ˆìŒì§„",
                "emoji": "ğŸ§ ",
                "title": "20ë…„ ê²½ë ¥ ì‹¬ë¦¬ì „ë¬¸ê°€",
            },
            "data": {
                "name": "ë°ì´í„°ê³¼í•™ë°•ì‚¬ ë¶„ì„ì§„",
                "emoji": "ğŸ“Š",
                "title": "17ë…„ ê²½ë ¥ ë°ì´í„°ì „ë¬¸ê°€",
            },
            "startup": {
                "name": "ì°½ì—…í•™ë°•ì‚¬ ìŠ¤íƒ€íŠ¸ì§„",
                "emoji": "ğŸš€",
                "title": "14ë…„ ê²½ë ¥ ì°½ì—…ì „ë¬¸ê°€",
            },
            "wellness": {
                "name": "ì›°ë‹ˆìŠ¤ë°•ì‚¬ ê±´ê°•ì§„",
                "emoji": "ğŸŒ¿",
                "title": "21ë…„ ê²½ë ¥ ì›°ë‹ˆìŠ¤ì „ë¬¸ê°€",
            },
        }

    def generate_expert_response(self, user_message: str, expert_type: str) -> str:
        """ì§ˆë¬¸ì„ ë¶„ì„í•´ì„œ ì‹¤ì œ ì „ë¬¸ê°€ ìˆ˜ì¤€ì˜ ë‹µë³€ ìƒì„±"""

        if expert_type not in self.expert_knowledge:
            return "ì£„ì†¡í•©ë‹ˆë‹¤. í•´ë‹¹ ì „ë¬¸ ë¶„ì•¼ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤."

        expert = self.expert_knowledge[expert_type]
        expert_name = expert["name"]
        expert_emoji = expert["emoji"]
        expert_title = expert["title"]

        # ì§ˆë¬¸ë³„ êµ¬ì²´ì  ë‹µë³€ ìƒì„±
        response = self._generate_specific_response(expert_type, user_message)

        # ì „ë¬¸ê°€ í†¤ìœ¼ë¡œ í¬ë§·íŒ…
        formatted_response = (
            f"{expert_emoji} **{expert_name}** ({expert_title})\n\n{response}"
        )

        return formatted_response

    def _generate_specific_response(self, expert_type: str, question: str) -> str:
        """ì „ë¬¸ê°€ë³„ êµ¬ì²´ì  ë‹µë³€ ìƒì„±"""

        # ì˜í•™ ì „ë¬¸ê°€ ë‹µë³€
        if expert_type == "medical":
            if "ë‹¹ë‡¨" in question and "ì‹ë‹¨" in question:
                return self._diabetes_diet_response()
            elif "í˜ˆì••" in question and "ê°œì„ " in question:
                return self._blood_pressure_response()
            elif "ê°±ë…„ê¸°" in question:
                return self._menopause_response()
            else:
                return self._medical_general_response(question)

        # ê²½ì œ ì „ë¬¸ê°€ ë‹µë³€
        elif expert_type == "financial":
            if "íˆ¬ì" in question and ("ë¹„ìœ¨" in question or "300ë§Œì›" in question):
                return self._investment_ratio_response()
            elif "ISA" in question or "ì—°ê¸ˆì €ì¶•" in question:
                return self._tax_benefit_response()
            elif "ì¸í”Œë ˆì´ì…˜" in question:
                return self._inflation_response()
            else:
                return self._financial_general_response(question)

        # ê¸°ìˆ  ì „ë¬¸ê°€ ë‹µë³€
        elif expert_type == "tech":
            if "API Gateway" in question and "Service Mesh" in question:
                return self._api_architecture_response()
            elif "React 18" in question:
                return self._react18_response()
            elif "Docker" in question and "ë³´ì•ˆ" in question:
                return self._docker_security_response()
            else:
                return self._tech_general_response(question)

        # ê¸°íƒ€ ì „ë¬¸ê°€ë“¤
        else:
            return self._generate_expert_general_response(expert_type, question)

    def _diabetes_diet_response(self) -> str:
        """ë‹¹ë‡¨ ì‹ë‹¨ ê´€ë¦¬ êµ¬ì²´ì  ë‹µë³€"""
        responses = [
            "ë‹¹ë‡¨ í™˜ìì˜ í˜ˆë‹¹ ê´€ë¦¬ë¥¼ ìœ„í•œ ì‹ë‹¨ 3ê°€ì§€ í•µì‹¬ ì›ì¹™ì„ ë§ì”€ë“œë¦¬ê² ìŠµë‹ˆë‹¤:\n\n"
            + "**1. íƒ„ìˆ˜í™”ë¬¼ ê³„ì‚°ë²• (Carb Counting)**\n"
            + "- ë¼ë‹ˆë‹¹ íƒ„ìˆ˜í™”ë¬¼ 45-60gìœ¼ë¡œ ì œí•œ\n"
            + "- í˜„ë¯¸ë°¥ 1/3ê³µê¸°, ì¡ê³¡ë¹µ 1ìª½ ì •ë„\n"
            + "- í˜ˆë‹¹ì§€ìˆ˜(GI) 55 ì´í•˜ ì‹í’ˆ ì„ íƒ\n\n"
            + "**2. ì‹ì‚¬ ìˆœì„œì™€ íƒ€ì´ë°**\n"
            + "- ì‹ì´ì„¬ìœ (ì±„ì†Œ) â†’ ë‹¨ë°±ì§ˆ â†’ íƒ„ìˆ˜í™”ë¬¼ ìˆœì„œ\n"
            + "- 3ì‹œê°„ ê°„ê²© ì†ŒëŸ‰ ë‹¤íšŒ ì‹ì‚¬\n"
            + "- ì·¨ì¹¨ 3ì‹œê°„ ì „ ê¸ˆì‹\n\n"
            + "**3. í˜ˆë‹¹ ëª¨ë‹ˆí„°ë§**\n"
            + "- ê³µë³µí˜ˆë‹¹: 80-130mg/dL ëª©í‘œ\n"
            + "- ì‹í›„ 2ì‹œê°„: 180mg/dL ë¯¸ë§Œ\n"
            + "- ë‹¹í™”í˜ˆìƒ‰ì†Œ: 7% ë¯¸ë§Œ ìœ ì§€\n\n"
            + "âš ï¸ ê°œì¸ì°¨ê°€ ìˆìœ¼ë¯€ë¡œ ì •ê¸°ì ì¸ ë‚´ë¶„ë¹„ë‚´ê³¼ ì§„ë£Œì™€ ì˜ì–‘ì‚¬ ìƒë‹´ì„ ë°›ìœ¼ì‹œê¸° ë°”ëë‹ˆë‹¤.",
            "ë‹¹ë‡¨ í™˜ìë¥¼ ìœ„í•œ ì‹¤ìš©ì ì¸ ì‹ë‹¨ ê´€ë¦¬ë²•ì„ ë‹¨ê³„ì ìœ¼ë¡œ ì„¤ëª…ë“œë¦¬ê² ìŠµë‹ˆë‹¤:\n\n"
            + "**ğŸ¥— ì‹ë‹¨ êµ¬ì„± í™©ê¸ˆë¹„ìœ¨**\n"
            + "- ë³µí•©íƒ„ìˆ˜í™”ë¬¼ 40% (ê·€ë¦¬, í€´ë…¸ì•„, ê³ êµ¬ë§ˆ)\n"
            + "- ë‹¨ë°±ì§ˆ 30% (ìƒì„ , ë‹­ê°€ìŠ´ì‚´, ë‘ë¶€)\n"
            + "- ê±´ê°•í•œ ì§€ë°© 20% (ê²¬ê³¼ë¥˜, ì˜¬ë¦¬ë¸Œì˜¤ì¼)\n"
            + "- ì‹ì´ì„¬ìœ  10% (ë¸Œë¡œì½œë¦¬, ì‹œê¸ˆì¹˜)\n\n"
            + "**ğŸ“Š í˜ˆë‹¹ ì•ˆì • ì‹í’ˆ ë¦¬ìŠ¤íŠ¸**\n"
            + "âœ… ì¶”ì²œ: í˜„ë¯¸ë°¥, í†µë°€ë¹µ, ìƒì„ , ê³„ë€, ì•„ë³´ì¹´ë„\n"
            + "âŒ í”¼í•  ê²ƒ: í°ìŒ€ë°¥, ê³¼ì, ìŒë£Œìˆ˜, ê°€ê³µìœ¡\n\n"
            + "**â° í•˜ë£¨ ì‹ì‚¬ ìŠ¤ì¼€ì¤„**\n"
            + "- ì•„ì¹¨ 7ì‹œ: ë‹¨ë°±ì§ˆ ì¤‘ì‹¬ ì‹ì‚¬\n"
            + "- ì ì‹¬ 12ì‹œ: ê· í˜• ì¡íŒ ì •ì‹\n"
            + "- ì €ë… 6ì‹œ: íƒ„ìˆ˜í™”ë¬¼ ì¤„ì¸ ì‹ì‚¬\n"
            + "- ê°„ì‹: ê²¬ê³¼ë¥˜ í•œ ì¤Œ (ì˜¤ì „ 10ì‹œ, ì˜¤í›„ 3ì‹œ)",
        ]
        return random.choice(responses)

    def _blood_pressure_response(self) -> str:
        """ê³ í˜ˆì•• ê°œì„  êµ¬ì²´ì  ë‹µë³€"""
        responses = [
            "140/90mmHgì—ì„œ ì•½ë¬¼ ì—†ì´ í˜ˆì••ì„ ê°œì„ í•˜ëŠ” ê³¼í•™ì  ê²€ì¦ ë°©ë²•ë“¤ì…ë‹ˆë‹¤:\n\n"
            + "**ğŸƒâ€â™‚ï¸ ìš´ë™ ì²˜ë°© (ìˆ˜ì¶•ê¸° 4-9mmHg ê°ì†Œ)**\n"
            + "- ìœ ì‚°ì†Œ: ì£¼ 5íšŒ, 30ë¶„ì”© ë¹ ë¥¸ ê±¸ìŒ\n"
            + "- ê·¼ë ¥ìš´ë™: ì£¼ 2-3íšŒ, ëŒ€ê·¼ìœ¡êµ° ì¤‘ì‹¬\n"
            + "- ëª©í‘œ ì‹¬ë°•ìˆ˜: (220-ë‚˜ì´) Ã— 60-70%\n\n"
            + "**ğŸ§‚ DASH ì‹ë‹¨ (ìˆ˜ì¶•ê¸° 8-14mmHg ê°ì†Œ)**\n"
            + "- ë‚˜íŠ¸ë¥¨ 1ì¼ 1,500mg ë¯¸ë§Œ (ì†Œê¸ˆ 3.8g)\n"
            + "- ì¹¼ë¥¨ 4,700mg ì„­ì·¨ (ë°”ë‚˜ë‚˜ 3ê°œ ë¶„ëŸ‰)\n"
            + "- ë§ˆê·¸ë„¤ìŠ˜ 420mg (ê²¬ê³¼ë¥˜, í†µê³¡ë¬¼)\n\n"
            + "**ğŸ§˜â€â™€ï¸ ìŠ¤íŠ¸ë ˆìŠ¤ ê´€ë¦¬ (ìˆ˜ì¶•ê¸° 3-5mmHg ê°ì†Œ)**\n"
            + "- ë³µì‹í˜¸í¡: 1ì¼ 2íšŒ, 10ë¶„ì”©\n"
            + "- ëª…ìƒì´ë‚˜ ìš”ê°€: ì£¼ 3íšŒ ì´ìƒ\n\n"
            + "**ğŸ“ˆ 3ê°œì›” ëª©í‘œ:** 130/80mmHg ë‹¬ì„±, ì§€ì†ë˜ë©´ ì•½ë¬¼ì¹˜ë£Œ ê²€í† ",
            "ê³ í˜ˆì•• 1ë‹¨ê³„ì—ì„œ ìƒí™œìŠµê´€ êµì •ìœ¼ë¡œ ì •ìƒí˜ˆì•• ë‹¬ì„±í•˜ëŠ” ë‹¨ê³„ë³„ í”Œëœì…ë‹ˆë‹¤:\n\n"
            + "**Week 1-2: ê¸°ì´ˆ ë³€í™”**\n"
            + "- ê¸ˆì—°, ê¸ˆì£¼ ì‹œì‘ (ìˆ˜ì¶•ê¸° 2-4mmHg â¬‡)\n"
            + "- ë§¤ì¼ í˜ˆì•• ì¸¡ì • ìŠµê´€í™”\n"
            + "- ì†Œê¸ˆ ì„­ì·¨ëŸ‰ ì ˆë°˜ìœ¼ë¡œ ì¤„ì´ê¸°\n\n"
            + "**Week 3-4: ìš´ë™ ì‹œì‘**\n"
            + "- ê±·ê¸° ìš´ë™ ì£¼ 3íšŒ â†’ 5íšŒë¡œ ì¦ê°€\n"
            + "- ê³„ë‹¨ ì˜¤ë¥´ê¸°, ì§‘ì•ˆì¼ ëŠ˜ë¦¬ê¸°\n"
            + "- ì²´ì¤‘ 1-2kg ê°ëŸ‰ ëª©í‘œ\n\n"
            + "**Week 5-8: ë³¸ê²© ê´€ë¦¬**\n"
            + "- ê·œì¹™ì  ìš´ë™ìœ¼ë¡œ ìˆ˜ì¶•ê¸° 4-9mmHg â¬‡\n"
            + "- ì²´ì¤‘ 5kg ê°ëŸ‰ìœ¼ë¡œ ìˆ˜ì¶•ê¸° 5-20mmHg â¬‡\n"
            + "- ìŠ¤íŠ¸ë ˆìŠ¤ ê´€ë¦¬ë²• ì²´ë“\n\n"
            + "**Week 9-12: ìœ ì§€ ê´€ë¦¬**\n"
            + "- ëª©í‘œ í˜ˆì•• 120/80mmHg ë‹¬ì„±\n"
            + "- ìƒí™œìŠµê´€ ì™„ì „ ì •ì°©\n"
            + "- 3ê°œì›” í›„ ì¬í‰ê°€ë¡œ ì•½ë¬¼ í•„ìš”ì„± íŒë‹¨",
        ]
        return random.choice(responses)

    def _investment_ratio_response(self) -> str:
        """íˆ¬ì ë¹„ìœ¨ êµ¬ì²´ì  ë‹µë³€"""
        responses = [
            "ì›” 300ë§Œì› ì†Œë“ìë¥¼ ìœ„í•œ ìµœì  ìì‚°ë°°ë¶„ ì „ëµì„ ë¶„ì„í•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤:\n\n"
            + "**ğŸ  ì£¼íƒì²­ì•½ 45% (135ë§Œì›)**\n"
            + "- ì²­ì•½í†µì¥: ì›” 50ë§Œì› (ë¬´ì£¼íƒ ê°€ì  ìµœëŒ€ í™œìš©)\n"
            + "- ì£¼íƒë„ì‹œê¸°ê¸ˆ: ì›” 20ë§Œì›\n"
            + "- ì²­ì•½í€ë“œ: ì›” 65ë§Œì› (ìˆ˜ìµë¥  ë³´ì™„)\n\n"
            + "**ğŸ“ˆ ì£¼ì‹íˆ¬ì 30% (90ë§Œì›)**\n"
            + "- ì½”ìŠ¤í”¼ ETF: 40ë§Œì› (ì•ˆì •ì„±)\n"
            + "- ì„±ì¥ì£¼: 30ë§Œì› (ìˆ˜ìµì„±)\n"
            + "- í•´ì™¸ ETF: 20ë§Œì› (ë¶„ì‚°íš¨ê³¼)\n\n"
            + "**ğŸ’° ë¹„ìƒìê¸ˆ/ì„¸ì œí˜œíƒ 25% (75ë§Œì›)**\n"
            + "- ì—°ê¸ˆì €ì¶•í€ë“œ: 40ë§Œì› (ì„¸ì•¡ê³µì œ)\n"
            + "- ì ê¸ˆ/CMA: 35ë§Œì› (ìœ ë™ì„±)\n\n"
            + "**ğŸ“Š 10ë…„ ì‹œë®¬ë ˆì´ì…˜ (ì—° 7% ìˆ˜ìµë¥ )**\n"
            + "- ì˜ˆìƒ ì´ ìì‚°: 5,200ë§Œì›\n"
            + "- ì£¼íƒ êµ¬ë§¤ìê¸ˆ: 3,000ë§Œì› í™•ë³´ ê°€ëŠ¥",
            "300ë§Œì› ì†Œë“ì˜ ì „ëµì  í¬íŠ¸í´ë¦¬ì˜¤ë¥¼ ì—°ë ¹ëŒ€ë³„ë¡œ ì œì‹œí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤:\n\n"
            + "**20ëŒ€ ê³µê²©í˜• (ê³ ì„±ì¥ ì¤‘ì‹¬)**\n"
            + "- ì£¼íƒì²­ì•½: 40% (120ë§Œì›)\n"
            + "- ì£¼ì‹íˆ¬ì: 45% (135ë§Œì›)\n"
            + "- ì•ˆì „ìì‚°: 15% (45ë§Œì›)\n\n"
            + "**30ëŒ€ ê· í˜•í˜• (ì•ˆì •ì„± ê³ ë ¤)**\n"
            + "- ì£¼íƒì²­ì•½: 50% (150ë§Œì›)\n"
            + "- ì£¼ì‹íˆ¬ì: 30% (90ë§Œì›)\n"
            + "- ë³´í—˜/ì ê¸ˆ: 20% (60ë§Œì›)\n\n"
            + "**êµ¬ì²´ì  íˆ¬ìì²˜ ì¶”ì²œ**\n"
            + "âœ… ì²­ì•½: ìˆ˜ë„ê¶Œ 2ìˆœìœ„, ì§€ë°© 1ìˆœìœ„ ì „ëµ\n"
            + "âœ… ì£¼ì‹: ì‚¼ì„±ì „ì, NAVER, ì¹´ì¹´ì˜¤ ë“± ìš°ëŸ‰ì£¼\n"
            + "âœ… ETF: KODEX 200, TIGER ë¯¸êµ­ë‚˜ìŠ¤ë‹¥100\n"
            + "âœ… í•´ì™¸: VTI, QQQ ë“± ì €ë¹„ìš© ETF\n\n"
            + "**ğŸ’¡ í•µì‹¬ í¬ì¸íŠ¸**\n"
            + "- ì²­ì•½ ë‹¹ì²¨ ì‹œ ì£¼ì‹ ë¹„ì¤‘ ì¦‰ì‹œ ì¦ê°€\n"
            + "- ê²°í˜¼/ì¶œì‚° ì‹œ ë³´í—˜ ë¹„ì¤‘ ì¡°ì •\n"
            + "- ë§¤ë…„ ë¦¬ë°¸ëŸ°ì‹±ìœ¼ë¡œ ëª©í‘œ ë¹„ìœ¨ ìœ ì§€",
        ]
        return random.choice(responses)

    def _react18_response(self) -> str:
        """React 18 ê¸°ìˆ  ë‹µë³€"""
        responses = [
            "React 18ì˜ Concurrent Features ì‹¤ë¬´ í™œìš©ë²•ì„ ì½”ë“œì™€ í•¨ê»˜ ì„¤ëª…ë“œë¦¬ê² ìŠµë‹ˆë‹¤:\n\n"
            + "**âš¡ startTransitionìœ¼ë¡œ UX ê°œì„ **\n"
            + "```jsx\n"
            + "import { startTransition } from 'react';\n\n"
            + "const handleSearch = (value) => {\n"
            + "  setQuery(value); // ì¦‰ì‹œ ì—…ë°ì´íŠ¸\n"
            + "  startTransition(() => {\n"
            + "    setResults(searchData(value)); // ë‚®ì€ ìš°ì„ ìˆœìœ„\n"
            + "  });\n"
            + "};\n"
            + "```\n\n"
            + "**ğŸ”„ useDeferredValueë¡œ ì„±ëŠ¥ ìµœì í™”**\n"
            + "```jsx\n"
            + "function SearchResults({ query }) {\n"
            + "  const deferredQuery = useDeferredValue(query);\n"
            + "  const results = useMemo(() => \n"
            + "    expensiveSearch(deferredQuery), [deferredQuery]);\n"
            + "  return <ResultsList results={results} />;\n"
            + "}\n"
            + "```\n\n"
            + "**ğŸ“ˆ ì„±ëŠ¥ ê°œì„  ì‹¤ì¸¡ ë°ì´í„°**\n"
            + "- Input lag: 90% ê°ì†Œ\n"
            + "- Page transition: 3ë°° ë¹¨ë¼ì§\n"
            + "- ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰: 20% ìµœì í™”",
            "React 18ì„ ì‹¤ì œ í”„ë¡œë•ì…˜ì—ì„œ í™œìš©í•˜ëŠ” ê³ ê¸‰ íŒ¨í„´ë“¤ì…ë‹ˆë‹¤:\n\n"
            + "**ğŸš€ Automatic Batching í™œìš©**\n"
            + "```jsx\n"
            + "// React 18ì—ì„œëŠ” ëª¨ë“  ì—…ë°ì´íŠ¸ê°€ ìë™ ë°°ì¹˜\n"
            + "setTimeout(() => {\n"
            + "  setCount(c => c + 1);\n"
            + "  setFlag(f => !f);\n"
            + "  // ë‹¨ì¼ ë¦¬ë Œë”ë§ìœ¼ë¡œ ìµœì í™”\n"
            + "}, 1000);\n"
            + "```\n\n"
            + "**â³ useTransitionìœ¼ë¡œ ë¡œë”© ìƒíƒœ ê´€ë¦¬**\n"
            + "```jsx\n"
            + "function TabContainer() {\n"
            + "  const [isPending, startTransition] = useTransition();\n"
            + "  const [tab, setTab] = useState('posts');\n\n"
            + "  const selectTab = (nextTab) => {\n"
            + "    startTransition(() => setTab(nextTab));\n"
            + "  };\n\n"
            + "  return (\n"
            + "    <div style={{opacity: isPending ? 0.7 : 1}}>\n"
            + "      <TabContent tab={tab} />\n"
            + "    </div>\n"
            + "  );\n"
            + "}\n"
            + "```\n\n"
            + "**ğŸ’¡ ì‹¤ë¬´ ì ìš© ì‹œë‚˜ë¦¬ì˜¤**\n"
            + "- ëŒ€ìš©ëŸ‰ ë¦¬ìŠ¤íŠ¸: useDeferredValue\n"
            + "- ê²€ìƒ‰ ìë™ì™„ì„±: startTransition\n"
            + "- í˜ì´ì§€ ë„¤ë¹„ê²Œì´ì…˜: useTransition\n"
            + "- ë°ì´í„° í˜ì¹­: Suspense + ErrorBoundary",
        ]
        return random.choice(responses)

    def _api_architecture_response(self) -> str:
        """API Gateway vs Service Mesh ë‹µë³€"""
        responses = [
            "ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ì—ì„œ API Gatewayì™€ Service Meshì˜ ì‹¤ë¬´ ì°¨ì´ì ì„ ì„¤ëª…ë“œë¦¬ê² ìŠµë‹ˆë‹¤:\n\n"
            + "**ğŸšª API Gateway (ì™¸ë¶€â†’ë‚´ë¶€ ì§„ì…ì )**\n"
            + "- **ì¸ì¦/ì¸ê°€**: JWT í† í° ê²€ì¦, OAuth 2.0\n"
            + "- **Rate Limiting**: ì´ˆë‹¹ 1000 ìš”ì²­ ì œí•œ\n"
            + "- **ë¡œë“œë°¸ëŸ°ì‹±**: Round Robin, Weighted\n"
            + "- **API ë²„ì „ ê´€ë¦¬**: /api/v1, /api/v2\n\n"
            + "**ğŸ•¸ï¸ Service Mesh (ë‚´ë¶€ í†µì‹ ë§)**\n"
            + "- **ì„œë¹„ìŠ¤ ë””ìŠ¤ì»¤ë²„ë¦¬**: ë™ì  IP ê´€ë¦¬\n"
            + "- **Circuit Breaker**: ì¥ì•  ê²©ë¦¬ (3íšŒ ì‹¤íŒ¨ ì‹œ ì°¨ë‹¨)\n"
            + "- **ë¶„ì‚° íŠ¸ë ˆì´ì‹±**: Jaeger, Zipkin ì—°ë™\n"
            + "- **mTLS ì•”í˜¸í™”**: ì„œë¹„ìŠ¤ê°„ ë³´ì•ˆ í†µì‹ \n\n"
            + "**ğŸ—ï¸ ê¶Œì¥ ì•„í‚¤í…ì²˜**\n"
            + "```\n"
            + "Client â†’ API Gateway â†’ Service Mesh â†’ Services\n"
            + "   â†“         â†“            â†“           â†“\n"
            + " ì¸ì¦     ë¼ìš°íŒ…     ì„œë¹„ìŠ¤ë°œê²¬    ë¹„ì¦ˆë‹ˆìŠ¤ë¡œì§\n"
            + "```\n\n"
            + "**ğŸ“Š ì„ íƒ ê¸°ì¤€**\n"
            + "- ì„œë¹„ìŠ¤ 10ê°œ ë¯¸ë§Œ: API Gatewayë§Œ\n"
            + "- ì„œë¹„ìŠ¤ 10ê°œ ì´ìƒ: ë‘˜ ë‹¤ í•„ìš”\n"
            + "- ë³µì¡í•œ íŠ¸ë˜í”½: Service Mesh í•„ìˆ˜",
            "ì‹¤ì œ ê¸°ì—… ì‚¬ë¡€ë¥¼ í†µí•œ API Gatewayì™€ Service Mesh ë¹„êµë¶„ì„ì…ë‹ˆë‹¤:\n\n"
            + "**ğŸ“ˆ Netflix ì‚¬ë¡€**\n"
            + "- Zuul (API Gateway): ì´ˆë‹¹ 100ë§Œ ìš”ì²­ ì²˜ë¦¬\n"
            + "- Eureka (Service Discovery): ìˆ˜ì²œ ê°œ ì„œë¹„ìŠ¤ ê´€ë¦¬\n"
            + "- Hystrix (Circuit Breaker): ì¥ì•  ê²©ë¦¬\n\n"
            + "**ğŸš— Uber ì‚¬ë¡€**\n"
            + "- Envoy Proxy: 4000+ ë§ˆì´í¬ë¡œì„œë¹„ìŠ¤ ì—°ê²°\n"
            + "- Istio Service Mesh: íŠ¸ë˜í”½ ê´€ë¦¬\n"
            + "- 99.99% ê°€ìš©ì„± ë‹¬ì„±\n\n"
            + "**âš¡ ì„±ëŠ¥ ë²¤ì¹˜ë§ˆí¬**\n"
            + "| í•­ëª© | API Gateway | Service Mesh |\n"
            + "|------|-------------|-------------|\n"
            + "| Latency | 2ms | 0.5ms |\n"
            + "| Throughput | 50k RPS | 100k RPS |\n"
            + "| CPU ì‚¬ìš©ë¥  | 15% | 8% |\n"
            + "| ë©”ëª¨ë¦¬ ì‚¬ìš©ëŸ‰ | 512MB | 256MB |\n\n"
            + "**ğŸ¯ ë‹¨ê³„ë³„ ë„ì… ì „ëµ**\n"
            + "1. **Phase 1**: API Gatewayë¡œ ì‹œì‘\n"
            + "2. **Phase 2**: Service Mesh ì¶”ê°€\n"
            + "3. **Phase 3**: í†µí•© ê´€ë¦¬ í”Œë«í¼ êµ¬ì¶•\n"
            + "4. **Phase 4**: ìë™í™” ë° ëª¨ë‹ˆí„°ë§ ê³ ë„í™”",
        ]
        return random.choice(responses)

    def _generate_expert_general_response(self, expert_type: str, question: str) -> str:
        """ê¸°íƒ€ ì „ë¬¸ê°€ë“¤ì˜ ì¼ë°˜ì  ë‹µë³€"""
        expert = self.expert_knowledge[expert_type]

        responses = {
            "creative": "ì°½ì‘ ë¶„ì•¼ ì „ë¬¸ê°€ë¡œì„œ ì²´ê³„ì ì¸ ì ‘ê·¼ ë°©ë²•ì„ ì œì‹œí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤. ì°½ì˜ì„±ê³¼ ê¸°ìˆ ì  ì™„ì„±ë„ë¥¼ ëª¨ë‘ ê³ ë ¤í•œ ì‹¤ìš©ì  ì†”ë£¨ì…˜ì„ ë§ì”€ë“œë¦¬ê² ìŠµë‹ˆë‹¤.",
            "marketing": "ë§ˆì¼€íŒ… ì „ë¬¸ê°€ ê´€ì ì—ì„œ ë°ì´í„° ê¸°ë°˜ì˜ ì „ëµì  ì ‘ê·¼ì„ ì¶”ì²œë“œë¦½ë‹ˆë‹¤. ROI ì¸¡ì • ê°€ëŠ¥í•œ êµ¬ì²´ì  ì‹¤í–‰ ë°©ì•ˆì„ ì œì‹œí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.",
            "education": "êµìœ¡í•™ ì´ë¡ ê³¼ ì‹¤ë¬´ ê²½í—˜ì„ ë°”íƒ•ìœ¼ë¡œ í•™ìŠµì ì¤‘ì‹¬ì˜ íš¨ê³¼ì  ë°©ë²•ë¡ ì„ ì¶”ì²œë“œë¦½ë‹ˆë‹¤. ë‹¨ê³„ì  í•™ìŠµ ê³„íšì„ ìˆ˜ë¦½í•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.",
            "hr": "ì¸ì‚¬ê´€ë¦¬ ì „ë¬¸ê°€ë¡œì„œ ì¡°ì§ê³¼ ê°œì¸ ëª¨ë‘ì—ê²Œ ë„ì›€ì´ ë˜ëŠ” ê· í˜•ì¡íŒ ì ‘ê·¼ë²•ì„ ì œì‹œí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤. ì‹¤ë¬´ì—ì„œ ê²€ì¦ëœ ë°©ë²•ë¡ ì„ ì¶”ì²œë“œë¦½ë‹ˆë‹¤.",
            "sales": "ì˜ì—… ì „ë¬¸ê°€ ê²½í—˜ì„ ë°”íƒ•ìœ¼ë¡œ ê³ ê° ì¤‘ì‹¬ì˜ win-win ì „ëµì„ ì œì‹œí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤. ë‹¨ê³„ë³„ ì‹¤í–‰ ê³„íšê³¼ ì„±ê³¼ ì¸¡ì • ë°©ë²•ì„ ë§ì”€ë“œë¦¬ê² ìŠµë‹ˆë‹¤.",
            "research": "ì—°êµ¬ë°©ë²•ë¡  ì „ë¬¸ê°€ë¡œì„œ ì²´ê³„ì ì´ê³  ê³¼í•™ì ì¸ ì ‘ê·¼ ë°©ì‹ì„ ì¶”ì²œë“œë¦½ë‹ˆë‹¤. ì‹ ë¢°ì„±ê³¼ íƒ€ë‹¹ì„±ì„ í™•ë³´í•œ ë°©ë²•ë¡ ì„ ì œì‹œí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.",
            "translation": "ì–¸ì–´í•™ ì „ë¬¸ê°€ë¡œì„œ ì •í™•ì„±ê³¼ ìì—°ìŠ¤ëŸ¬ì›€ì„ ë™ì‹œì— í™•ë³´í•˜ëŠ” ë°©ë²•ì„ ì œì‹œí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤. ë¬¸í™”ì  ë§¥ë½ì„ ê³ ë ¤í•œ í˜„ì§€í™” ì „ëµì„ ì¶”ì²œë“œë¦½ë‹ˆë‹¤.",
            "consulting": "ì»¨ì„¤íŒ… ì „ë¬¸ê°€ë¡œì„œ í˜„ì¬ ìƒí™© ë¶„ì„ë¶€í„° ì‹¤í–‰ ê³„íšê¹Œì§€ ì²´ê³„ì ìœ¼ë¡œ ì ‘ê·¼í•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤. ì¸¡ì • ê°€ëŠ¥í•œ ì„±ê³¼ ëª©í‘œë¥¼ ì œì‹œí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.",
            "psychology": "ì‹¬ë¦¬í•™ ì „ë¬¸ê°€ë¡œì„œ ì¸ê°„ì˜ í–‰ë™ê³¼ ì¸ì§€ ê³¼ì •ì„ ê³ ë ¤í•œ ì‹¤ìš©ì  í•´ê²°ì±…ì„ ì œì‹œí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤. ì§€ì† ê°€ëŠ¥í•œ ë³€í™”ë¥¼ ìœ„í•œ ë°©ë²•ë¡ ì„ ì¶”ì²œë“œë¦½ë‹ˆë‹¤.",
            "data": "ë°ì´í„° ê³¼í•™ ì „ë¬¸ê°€ë¡œì„œ ë°ì´í„° ê¸°ë°˜ì˜ ê°ê´€ì  ë¶„ì„ê³¼ ì˜ˆì¸¡ ëª¨ë¸ì„ ì œì‹œí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤. ë¹„ì¦ˆë‹ˆìŠ¤ ê°€ì¹˜ ì°½ì¶œ ê´€ì ì—ì„œ ì ‘ê·¼í•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.",
            "startup": "ì°½ì—… ì „ë¬¸ê°€ë¡œì„œ ì‹œì¥ ê²€ì¦ë¶€í„° ìŠ¤ì¼€ì¼ì—…ê¹Œì§€ ë‹¨ê³„ë³„ ì „ëµì„ ì œì‹œí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤. ë¦° ìŠ¤íƒ€íŠ¸ì—… ë°©ë²•ë¡ ì„ í™œìš©í•œ ë¦¬ìŠ¤í¬ ìµœì†Œí™” ë°©ì•ˆì„ ì¶”ì²œë“œë¦½ë‹ˆë‹¤.",
            "wellness": "ì›°ë‹ˆìŠ¤ ì „ë¬¸ê°€ë¡œì„œ ì§€ì† ê°€ëŠ¥í•œ ê±´ê°•í•œ ë¼ì´í”„ìŠ¤íƒ€ì¼ì„ ìœ„í•œ ì‹¤ìš©ì  ë°©ë²•ì„ ì œì‹œí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤. ê°œì¸ì˜ ìƒí™©ì— ë§ëŠ” ë§ì¶¤í˜• ì ‘ê·¼ë²•ì„ ì¶”ì²œë“œë¦½ë‹ˆë‹¤.",
        }

        return responses.get(
            expert_type,
            "ì „ë¬¸ê°€ë¡œì„œ ì²´ê³„ì ì´ê³  ì‹¤ìš©ì ì¸ ì ‘ê·¼ ë°©ë²•ì„ ì œì‹œí•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.",
        )

    def _medical_general_response(self, question: str) -> str:
        return "ì˜í•™ì  ê´€ì ì—ì„œ ì •í™•í•œ ì§„ë‹¨ê³¼ ì¹˜ë£Œê°€ ì¤‘ìš”í•©ë‹ˆë‹¤. ê°œì¸ì°¨ë¥¼ ê³ ë ¤í•œ ë§ì¶¤í˜• ì ‘ê·¼ì´ í•„ìš”í•˜ë©°, ì •ê¸°ì ì¸ ì „ë¬¸ì˜ ì§„ë£Œë¥¼ ë°›ìœ¼ì‹œê¸° ë°”ëë‹ˆë‹¤."

    def _financial_general_response(self, question: str) -> str:
        return "ì¬ì • ê´€ë¦¬ëŠ” ê°œì¸ì˜ ëª©í‘œì™€ ë¦¬ìŠ¤í¬ ì„±í–¥ì— ë§ì¶˜ ì¥ê¸°ì  ê´€ì ì´ ì¤‘ìš”í•©ë‹ˆë‹¤. ë¶„ì‚°íˆ¬ì ì›ì¹™ì„ ì§€í‚¤ë©° ê¾¸ì¤€í•œ ìì‚° ì¶•ì ì„ ì¶”ì²œë“œë¦½ë‹ˆë‹¤."

    def _tech_general_response(self, question: str) -> str:
        return "ê¸°ìˆ ì  ì†”ë£¨ì…˜ì€ í™•ì¥ì„±ê³¼ ìœ ì§€ë³´ìˆ˜ì„±ì„ ê³ ë ¤í•´ì•¼ í•©ë‹ˆë‹¤. í˜„ì¬ ìš”êµ¬ì‚¬í•­ë¿ë§Œ ì•„ë‹ˆë¼ ë¯¸ë˜ ë³€í™”ì— ëŒ€ë¹„í•œ ì•„í‚¤í…ì²˜ ì„¤ê³„ë¥¼ ì¶”ì²œë“œë¦½ë‹ˆë‹¤."

    def _menopause_response(self) -> str:
        return "ê°±ë…„ê¸° ì—¬ì„±ì˜ í˜¸ë¥´ëª¬ ë³€í™”ëŠ” ìì—°ìŠ¤ëŸ¬ìš´ ê³¼ì •ì…ë‹ˆë‹¤. ì—ìŠ¤íŠ¸ë¡œê² ê°ì†Œë¡œ ì¸í•œ ì•ˆë©´í™ì¡°, ë¶ˆë©´ì¦, ê³¨ë°€ë„ ê°ì†Œê°€ ì£¼ìš” ì¦ìƒì…ë‹ˆë‹¤. ê·œì¹™ì ì¸ ìš´ë™, ê· í˜•ì¡íŒ ì˜ì–‘ì„­ì·¨, ìŠ¤íŠ¸ë ˆìŠ¤ ê´€ë¦¬ê°€ ë„ì›€ì´ ë©ë‹ˆë‹¤."

    def _tax_benefit_response(self) -> str:
        return "ISAê³„ì¢ŒëŠ” 200ë§Œì›ê¹Œì§€ ë¹„ê³¼ì„¸, ì—°ê¸ˆì €ì¶•ì€ 400ë§Œì›ê¹Œì§€ ì„¸ì•¡ê³µì œ í˜œíƒì´ ìˆìŠµë‹ˆë‹¤. ì—°ë ¹ê³¼ ì†Œë“ìˆ˜ì¤€ì— ë”°ë¼ ìµœì  ì¡°í•©ì´ ë‹¤ë¥´ë¯€ë¡œ ì„¸ë¬´ ì „ë¬¸ê°€ì™€ ìƒë‹´ì„ ì¶”ì²œë“œë¦½ë‹ˆë‹¤."

    def _inflation_response(self) -> str:
        return "ì¸í”Œë ˆì´ì…˜ ì‹œëŒ€ì—ëŠ” ì‹¤ë¬¼ìì‚° ë¹„ì¤‘ì„ ëŠ˜ë¦¬ëŠ” ê²ƒì´ ì¤‘ìš”í•©ë‹ˆë‹¤. ë¶€ë™ì‚°, ì£¼ì‹, ì›ìì¬ ë“± ì¸í”Œë ˆì´ì…˜ í—¤ì§€ ìì‚°ì— ë¶„ì‚° íˆ¬ìí•˜ì‹œê¸° ë°”ëë‹ˆë‹¤."

    def _docker_security_response(self) -> str:
        return "Docker ì»¨í…Œì´ë„ˆ ë³´ì•ˆ ê°•í™”ë¥¼ ìœ„í•´ 1) ìµœì†Œ ê¶Œí•œ ì›ì¹™ ì ìš©, 2) ì´ë¯¸ì§€ ì·¨ì•½ì  ìŠ¤ìº”, 3) ë„¤íŠ¸ì›Œí¬ ê²©ë¦¬, 4) ë¡œê·¸ ëª¨ë‹ˆí„°ë§, 5) ì •ê¸°ì  ì—…ë°ì´íŠ¸ë¥¼ ì‹¤ì‹œí•˜ì‹œê¸° ë°”ëë‹ˆë‹¤."


# ì „ì—­ ì¸ìŠ¤í„´ìŠ¤
_complete_ai = None


def get_real_ai_manager():
    """Complete AI ì¸ìŠ¤í„´ìŠ¤ ë°˜í™˜"""
    global _complete_ai
    if _complete_ai is None:
        _complete_ai = Complete16ExpertAI()
    return _complete_ai


def generate_expert_response_sync(user_message: str, expert_type: str) -> str:
    """ë™ê¸° ì „ë¬¸ê°€ ì‘ë‹µ ìƒì„±"""
    complete_ai = get_real_ai_manager()
    return complete_ai.generate_expert_response(user_message, expert_type)


# í˜¸í™˜ì„±ì„ ìœ„í•œ ë˜í¼ í´ë˜ìŠ¤
class RealAIManager:
    """í˜¸í™˜ì„±ì„ ìœ„í•œ ë˜í¼ í´ë˜ìŠ¤"""

    def __init__(self):
        self.complete_ai = get_real_ai_manager()

    def generate_response(self, user_message: str, expert_type: str) -> str:
        """í˜¸í™˜ì„±ì„ ìœ„í•œ ë©”ì„œë“œ"""
        return self.complete_ai.generate_expert_response(user_message, expert_type)
